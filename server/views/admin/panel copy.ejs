<%
  const langs = [
    { key: 'de', label: 'Deutsch' },
    { key: 'en', label: 'Englisch' },
    { key: 'ku', label: 'Kurdisch' }
  ];
  const safeValue = (value) => value || '';
  const isChecked = (value) => (value ? 'checked' : '');
  const faqRows = [1, 2, 3, 4, 5];
  const donationAmountRows = [1, 2, 3, 4, 5];
  const welcomeLinkRows = [1, 2, 3, 4];
  const localeData = (data, key) => data?.[key] || {};
  const welcomeMediaPreview = homePageData?.de?.welcome?.mediaSrc
    || homePageData?.en?.welcome?.mediaSrc
    || homePageData?.ku?.welcome?.mediaSrc
    || '';
  const heroModes = [
    { value: 'random', label: 'Zufälliges Video' },
    { value: 'manual', label: 'Video auswählen' }
  ];
    const filmCategoryOptions = [
    { value: 'Fokus', labels: { de: 'Fokus', en: 'Focus', ku: 'Fokus' } },
    { value: 'Dokumentar', labels: { de: 'Dokumentar', en: 'Documentary', ku: 'Belgefîlm' } },
    { value: 'Kurzfilm', labels: { de: 'Kurzfilm', en: 'Short film', ku: 'Fîlma kurt' } },
    { value: 'Kinder', labels: { de: 'Kinder', en: 'Kids', ku: 'Zarok' } },
    { value: 'Spielfilm', labels: { de: 'Spielfilm', en: 'Feature film', ku: 'Fîlmê dirêj' } }
  ];
  const ticketOptionList = (localeKey) => ticketOptionsByLocale?.[localeKey] || [];
  const ticketVisibilityMap = (localeKey) => ticketVisibilityByLocale?.[localeKey] || {};
  const ticketSettings = (localeKey) => ticketSettingsByLocale?.[localeKey] || { kino: {}, online: {} };
  const videoOptions = (localeKey) => videoOptionsByLocale?.[localeKey] || [];
  const directorOptions = (localeKey) => directorOptionsByLocale?.[localeKey] || [];
  const isSelected = (value, expected) => (String(value) === String(expected) ? 'selected' : '');
  const adminQuery = query || {};
  const adminError = adminQuery.error || '';
  const adminMissing = adminQuery.missing || '';
  const adminSaved = adminQuery.saved === '1';
  const articlesTab = adminQuery.articlesTab || 'create';
  const ticketsTab = adminQuery.ticketsTab || 'create';
  const adminMissingFields = String(adminQuery.missingFields || '')
    .split(',')
    .map((entry) => entry.trim())
    .filter(Boolean);
  const onlineAccessList = Array.isArray(onlineAccessCodes) ? onlineAccessCodes : [];
  const fieldHasError = (name) => adminMissingFields.includes(name);
  const articleGroups = Array.isArray(newsArticleGroups) ? newsArticleGroups : [];
  const selectedGroup = selectedNewsGroup || null;
  const selectedArticles = selectedGroup?.articles || {};
  const articleValue = (localeKey, field) => selectedArticles?.[localeKey]?.[field] || '';
    const galleryCategoryOptions = [
    { value: 'films', label: 'Filme' },
    { value: 'events', label: 'Veranstaltungen' },
    { value: 'moments', label: 'Momente vom Festival' }
  ];
  const galleryCategoryLabel = (value) => {
    const option = galleryCategoryOptions.find((entry) => entry.value === value);
    return option?.label || 'Momente vom Festival';
  };
  const articleGalleryItems = (localeKey) => {
    const raw = selectedArticles?.[localeKey]?.gallery;
    if (!raw) return [];
    if (Array.isArray(raw)) return raw;
    if (typeof raw === 'string') {
      try {
        const parsed = JSON.parse(raw);
        return Array.isArray(parsed) ? parsed : [];
      } catch {
        return [];
      }
    }
    return [];
  };
  const articleOptionList = articleGroups
    .map((group) => ({
      id: group.id,
      title: group.articles?.de?.title
    }))
    .filter((item) => item.title);
  const filmsTab = adminQuery.filmsTab || 'create';
  const directorsTab = adminQuery.directorsTab || 'create';
  const sponsorsTab = adminQuery.sponsorsTab || 'create';
  const mediaGroups = Array.isArray(mediaVideoGroups) ? mediaVideoGroups : [];
  const selectedMedia = selectedMediaGroup || null;
  const mediaVideos = selectedMedia?.videos || {};
  const mediaValue = (localeKey, field) => mediaVideos?.[localeKey]?.[field] || '';
  const mediaLanguagesValue = (localeKey) => {
    const raw = mediaVideos?.[localeKey]?.languages;
    if (Array.isArray(raw)) return raw.join(', ');
    return raw || '';
  };
  const mediaOtherImages = (localeKey) => {
    const raw = mediaVideos?.[localeKey]?.other_images;
    if (!raw) return [];
    if (Array.isArray(raw)) return raw;
    if (typeof raw === 'string') {
      try {
        const parsed = JSON.parse(raw);
        return Array.isArray(parsed) ? parsed : [];
      } catch {
        return [];
      }
    }
    return [];
  };
  const mediaOptionList = mediaGroups
    .map((group) => ({
      id: group.id,
      title: group.videos?.de?.title
    }))
    .filter((item) => item.title);
  const ticketGroups = Array.isArray(mediaTicketGroups) ? mediaTicketGroups : [];
  const selectedTicket = selectedTicketGroup || null;
  const ticketData = selectedTicket?.tickets || {};
  const ticketValue = (localeKey, field) => ticketData?.[localeKey]?.[field] || '';
  const ticketFeatures = (localeKey) => ticketData?.[localeKey]?.features || [];
  const ticketPhaseList = Object.values(ticketData)[0]?.phases || [];
  const ticketPhaseMap = ticketPhaseList.reduce((acc, phase) => {
    acc[phase.phase] = phase;
    return acc;
  }, {});
  const primaryTicket = ticketData.de || ticketData.en || ticketData.ku || {};
    const badgeColors = [
    { label: 'Festival-Gold', value: '#c2a486' },
    { label: 'Festival-Rot', value: '#d13e3e' },
    { label: 'Kurd-Gelb', value: '#fbe7b3' },
    { label: 'Accent-Blau', value: '#2251c2' }
  ];
  const baseEventPrice = primaryTicket.event_price || '';
  const standardKinoData = standardKinoTicket || null;
  const standardKinoPrice = standardKinoData?.base_price || '';
  const standardKinoPhases = Array.isArray(standardKinoData?.phases) ? standardKinoData.phases : [];
  const standardKinoPhaseMap = standardKinoPhases.reduce((acc, phase) => {
    acc[phase.phase] = phase;
    return acc;
  }, {});
  const formatDateValue = (value) => {
    if (!value) return '';
    const date = new Date(value);
    if (Number.isNaN(date.getTime())) return '';
    return date.toISOString().slice(0, 10);
  };
  const truncateText = (value, maxLength = 30) => {
    if (!value) return '';
    const text = String(value);
    if (text.length <= maxLength) return text;
    return `${text.slice(0, maxLength)}…`;
  };
  const calculateDiscountPercent = (phase) => {
    const base = Number(baseEventPrice);
    const current = Number(phase?.current_price);
    if (!Number.isFinite(base) || !Number.isFinite(current) || base === 0) return '';
    return Math.round((1 - (current / base)) * 100);
  };
  const calculateStandardDiscountPercent = (phase) => {
    const base = Number(standardKinoPrice);
    const current = Number(phase?.current_price);
    if (!Number.isFinite(base) || !Number.isFinite(current) || base === 0) return '';
    return Math.round((1 - (current / base)) * 100);
  };
  const ticketGroupOptions = ticketGroups
    .map((group) => ({
      id: group.id,
      title: group.tickets?.de?.title || group.tickets?.en?.title || group.tickets?.ku?.title || ''
    }))
    .filter((item) => item.title);
  const directorGroups = Array.isArray(directors) ? directors : [];
  const directorOptionList = directorGroups
    .map((director) => ({
      id: director.id,
      title: director.locales?.de?.name || director.locales?.en?.name || director.locales?.ku?.name || ''
    }))
    .filter((item) => item.title);
  const directorValue = (localeKey, field) => selectedDirector?.locales?.[localeKey]?.[field] || '';
  const selectedDirectorId = selectedDirector?.id || '';
  const newsletterTab = adminQuery.newsletterTab || 'overview';
  const newsletterError = adminQuery.newsletterError || '';
  const newsletterStatus = adminQuery.newsletterStatus || '';
  const newsletterCount = Number(adminQuery.newsletterCount || 0);
  const newsletterErrors = Number(adminQuery.newsletterErrors || 0);
  const newsletterFooterSaved = adminQuery.newsletterFooter === 'success';
  const formatDateTime = (value) => {
    if (!value) return '';
    const date = new Date(value);
    if (Number.isNaN(date.getTime())) return '';
    return date.toLocaleDateString('de-DE', { day: '2-digit', month: '2-digit', year: 'numeric' });
  };
  const formatBool = (value) => (value ? 'ja' : 'nein');
%>
<section class="admin-shell">
  <aside class="admin-sidebar">
    <div class="admin-sidebar__header">
      <h1>Admin Bereich</h1>
    </div>
    <div class="admin-profile">
      <div class="admin-avatar" aria-hidden="true">
        <span>A</span>
      </div>
      <div class="admin-profile__text">
        <strong><%= adminUser?.firstName || 'Admin' %> <%= adminUser?.lastName || '' %></strong>
        <span>eingeloggt</span>
      </div>
    </div>

    <nav class="admin-nav">
      <button class="admin-nav__item is-active" type="button" data-nav-group="pages">
        Webseiten bearbeiten
        <span class="admin-nav__chevron">‹</span>
      </button>
      <button class="admin-nav__item" type="button" data-nav-group="gallery">
        Admin Gallery
        <span class="admin-nav__chevron">›</span>
      </button>
      <button class="admin-nav__item" type="button" data-nav-group="newsletter">
        Newsletter Anmeldungen
        <span class="admin-nav__chevron">›</span>
      </button>
      <button class="admin-nav__item" type="button" data-nav-group="tickets">
        Tickets und Spenden
        <span class="admin-nav__chevron">›</span>
      </button>
      <button class="admin-nav__item" type="button" data-nav-group="articles">
        Artikel
        <span class="admin-nav__chevron">›</span>
      </button>
      <button class="admin-nav__item" type="button" data-nav-group="films">
        Filmbearbeitung
        <span class="admin-nav__chevron">›</span>
      </button>
      <button class="admin-nav__item" type="button" data-nav-group="directors">
        Regie hinzufügen
        <span class="admin-nav__chevron">›</span>
      </button>
      <button class="admin-nav__item" type="button" data-nav-group="sponsors">
        Sponsoren
        <span class="admin-nav__chevron">›</span>
      </button>
      <a class="admin-nav__item" href="/">
        Zur Startseite
        <span class="admin-nav__chevron">›</span>
      </a>
      <form method="post" action="/logout">
        <button class="admin-nav__item" type="submit">
          Logout
          <span class="admin-nav__chevron">›</span>
        </button>
      </form>
    </nav>
  </aside>

  <section class="admin-content">
    <div class="admin-content__section" data-nav-content="pages">
      <header class="admin-content__header">
        <h2>Wähle eine Seite</h2>
        <p>Hier kannst du den Inhalt alle Seiten bearbeiten und verändern</p>
        <div class="admin-tabs" data-admin-tabs="pages">
          <button class="admin-tab is-active" type="button" data-tab="startseite">Startseite</button>
          <button class="admin-tab" type="button" data-tab="news">News</button>
          <button class="admin-tab" type="button" data-tab="rahmenplan">Rahmenplan</button>
          <button class="admin-tab" type="button" data-tab="gallery">Gallery</button>
          <button class="admin-tab" type="button" data-tab="videos">Videos</button>
          <button class="admin-tab" type="button" data-tab="team">Team</button>
          <button class="admin-tab" type="button" data-tab="sponsoren">Sponsoren</button>
          <button class="admin-tab" type="button" data-tab="kinotickets">Kinotickets</button>
          <button class="admin-tab" type="button" data-tab="onlinetickets">Onlinetickets</button>
          <button class="admin-tab" type="button" data-tab="spenden">Spenden</button>
        </div>
      </header>

      <form class="admin-panel" method="post" action="/adminbackend/startseite" enctype="multipart/form-data" data-panel="startseite" data-panel-group="pages">
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Date / Fokus</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Datum <%= lang.label %>:</label>
              <input type="text" name="<%= lang.key %>_date" value="<%= safeValue(localeData(homePageData, lang.key)?.date) %>" placeholder="Datum eingeben...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Fokus <%= lang.label %>:</label>
              <input type="text" name="<%= lang.key %>_focus" value="<%= safeValue(localeData(homePageData, lang.key)?.focus) %>" placeholder="Fokus eingeben...">
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__section">
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Titel <%= lang.label %>:</label>
              <input type="text" name="<%= lang.key %>_title" value="<%= safeValue(localeData(homePageData, lang.key)?.title) %>" placeholder="Gib den Titel ein...">
            </div>
            <% }) %>
          </div>

          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Meta <%= lang.label %>:</label>
              <input type="text" name="<%= lang.key %>_meta" value="<%= safeValue(localeData(homePageData, lang.key)?.meta) %>" placeholder="Gib die Meta-Description ein...">
            </div>
            <% }) %>
          </div>

          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>H1 <%= lang.label %>:</label>
              <input type="text" name="<%= lang.key %>_h1" value="<%= safeValue(localeData(homePageData, lang.key)?.h1) %>" placeholder="Gib den H1 Titel ein...">
            </div>
            <% }) %>
          </div>

          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Beschreibung <%= lang.label %>:</label>
              <input type="text" name="<%= lang.key %>_description" value="<%= safeValue(localeData(homePageData, lang.key)?.description) %>" placeholder="Gib die Beschreibung ein...">
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Empfangsbereich:</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Überschrift <%= lang.label %>:</label>
              <input type="text" name="<%= lang.key %>_welcome_headline" value="<%= safeValue(localeData(homePageData, lang.key)?.welcome?.headline) %>" placeholder="Gib die Überschrift ein...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Empfangsbild (Video/Bild) <%= lang.label %>:</label>
              <div class="admin-media-picker" data-gallery-picker data-gallery-allow="image video">
                <div class="admin-media-picker__controls">
                  <button class="admin-button admin-button--secondary" type="button" data-gallery-open>Datei auswählen</button>
                  <button class="admin-button admin-button--secondary" type="button" data-upload-trigger>Datei hochladen</button>
                  <input type="file" name="<%= lang.key %>_welcome_media" accept="video/*,image/*" data-upload-input hidden>
                </div>
                <input type="hidden" name="<%= lang.key %>_welcome_gallery_image_id" data-gallery-input="image">
                <input type="hidden" name="<%= lang.key %>_welcome_gallery_video_id" data-gallery-input="video">
                <small data-gallery-preview>
                  <% if (localeData(homePageData, lang.key)?.welcome?.mediaSrc) { %>
                  Aktuell:
                  <a class="admin-media-picker__preview-link" href="<%= localeData(homePageData, lang.key)?.welcome?.mediaSrc %>" target="_blank" rel="noopener noreferrer" data-media-preview-url="<%= localeData(homePageData, lang.key)?.welcome?.mediaSrc %>" title="<%= localeData(homePageData, lang.key)?.welcome?.mediaSrc %>">
                    <%= truncateText(localeData(homePageData, lang.key)?.welcome?.mediaSrc) %>
                  </a>
                  <% } else if (welcomeMediaPreview) { %>
                  Aktuell:
                  <a class="admin-media-picker__preview-link" href="<%= welcomeMediaPreview %>" target="_blank" rel="noopener noreferrer" data-media-preview-url="<%= welcomeMediaPreview %>" title="<%= welcomeMediaPreview %>">
                    <%= truncateText(welcomeMediaPreview) %>
                  </a>
                  <% } else { %>
                  Keine Datei ausgewählt.
                  <% } %>
                </small>
              </div>
            </div>
            <% }) %>
          </div>
          <% welcomeLinkRows.forEach((row) => { %>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Link <%= row %> Label <%= lang.label %>:</label>
              <input type="text" name="<%= lang.key %>_welcome_link<%= row %>_label" value="<%= safeValue(localeData(homePageData, lang.key)?.welcome?.links?.[row - 1]?.label) %>" placeholder="Gib den Link-Text ein...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field admin-field--checkbox">
              <label class="blass">Anzeigen:</label>
              <input type="checkbox" name="<%= lang.key %>_welcome_link<%= row %>_enabled" <%= isChecked(localeData(homePageData, lang.key)?.welcome?.links?.[row - 1]?.enabled) %>>
            </div>
            <% }) %>
          </div>
          <% }) %>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Bereich Neuigkeiten:</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Titel <%= lang.label %>:</label>
              <input type="text" name="<%= lang.key %>_news_title" value="<%= safeValue(localeData(homePageData, lang.key)?.news?.title) %>" placeholder="Gib den Titel ein...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Beschreibung <%= lang.label %>:</label>
              <input type="text" name="<%= lang.key %>_news_description" value="<%= safeValue(localeData(homePageData, lang.key)?.news?.description) %>" placeholder="Gib die Beschreibung ein...">
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Bereich Videos:</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Titel <%= lang.label %>:</label>
              <input type="text" name="<%= lang.key %>_videos_title" value="<%= safeValue(localeData(homePageData, lang.key)?.videos?.title) %>" placeholder="Gib den Titel ein...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Beschreibung <%= lang.label %>:</label>
              <input type="text" name="<%= lang.key %>_videos_description" value="<%= safeValue(localeData(homePageData, lang.key)?.videos?.description) %>" placeholder="Gib die Beschreibung ein...">
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Bereich Tickets:</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Titel <%= lang.label %>:</label>
              <input type="text" name="<%= lang.key %>_tickets_title" value="<%= safeValue(localeData(homePageData, lang.key)?.tickets?.title) %>" placeholder="Gib den Titel ein...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Beschreibung <%= lang.label %>:</label>
              <input type="text" name="<%= lang.key %>_tickets_description" value="<%= safeValue(localeData(homePageData, lang.key)?.tickets?.description) %>" placeholder="Gib die Beschreibung ein...">
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Bereich FAQ:</h3>
          <% faqRows.forEach((row) => { %>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Frage <%= row %> <%= lang.label %>:</label>
              <input type="text" name="<%= lang.key %>_faq_q<%= row %>" value="<%= safeValue(localeData(homePageData, lang.key)?.faq?.[row - 1]?.question) %>" placeholder="Gib die Frage ein...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Antwort <%= row %> <%= lang.label %>:</label>
              <input type="text" name="<%= lang.key %>_faq_a<%= row %>" value="<%= safeValue(localeData(homePageData, lang.key)?.faq?.[row - 1]?.answer) %>" placeholder="Gib die Antwort ein...">
            </div>
            <% }) %>
          </div>
          <% }) %>
        </div>

        <div class="admin-panel__actions">
          <button type="submit" class="admin-button">Speichern ✓</button>
        </div>
      </form>

      <form class="admin-panel is-hidden" method="post" action="/adminbackend/news" enctype="multipart/form-data" data-panel="news" data-panel-group="pages">
        <div class="admin-panel__section">
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Titel <%= lang.label %>:</label>
              <input type="text" name="news_<%= lang.key %>_title" value="<%= safeValue(localeData(newsPageData, lang.key)?.title) %>" placeholder="Gib den Titel ein...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Meta <%= lang.label %>:</label>
              <input type="text" name="news_<%= lang.key %>_meta" value="<%= safeValue(localeData(newsPageData, lang.key)?.meta) %>" placeholder="Gib die Meta-Description ein...">
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Bereich Artikel:</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Titel <%= lang.label %>:</label>
              <input type="text" name="news_<%= lang.key %>_overview_headline" value="<%= safeValue(localeData(newsPageData, lang.key)?.overview?.headline) %>" placeholder="Gib den Titel ein...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Beschreibung <%= lang.label %>:</label>
              <input type="text" name="news_<%= lang.key %>_overview_text" value="<%= safeValue(localeData(newsPageData, lang.key)?.overview?.text) %>" placeholder="Gib die Beschreibung ein...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Button Label <%= lang.label %>:</label>
              <input type="text" name="news_<%= lang.key %>_overview_button" value="<%= safeValue(localeData(newsPageData, lang.key)?.overview?.buttonLabel) %>" placeholder="Gib das Button-Label ein...">
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Newsletter Bereich:</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Titel <%= lang.label %>:</label>
              <input type="text" name="news_<%= lang.key %>_newsletter_headline" value="<%= safeValue(localeData(newsPageData, lang.key)?.newsletter?.headline) %>" placeholder="Gib den Titel ein...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Beschreibung <%= lang.label %>:</label>
              <input type="text" name="news_<%= lang.key %>_newsletter_text" value="<%= safeValue(localeData(newsPageData, lang.key)?.newsletter?.text) %>" placeholder="Gib die Beschreibung ein...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Platzhalter <%= lang.label %>:</label>
              <input type="text" name="news_<%= lang.key %>_newsletter_placeholder" value="<%= safeValue(localeData(newsPageData, lang.key)?.newsletter?.placeholder) %>" placeholder="Gib den Platzhalter ein...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Button Label <%= lang.label %>:</label>
              <input type="text" name="news_<%= lang.key %>_newsletter_button" value="<%= safeValue(localeData(newsPageData, lang.key)?.newsletter?.buttonLabel) %>" placeholder="Gib das Button-Label ein...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Bild URL <%= lang.label %>:</label>
              <div class="admin-media-picker" data-gallery-picker data-gallery-allow="image">
                <div class="admin-media-picker__controls">
                  <button class="admin-button admin-button--secondary" type="button" data-gallery-open>Datei auswählen</button>
                  <button class="admin-button admin-button--secondary" type="button" data-upload-trigger>Datei hochladen</button>
                  <input type="file" name="news_<%= lang.key %>_newsletter_image_file" accept="image/*" data-upload-input hidden>
                </div>
                <input type="hidden" name="news_<%= lang.key %>_newsletter_gallery_image_id" data-gallery-input="image">
                <small data-gallery-preview>
                  <% if (localeData(newsPageData, lang.key)?.newsletter?.imageSrc) { %>
                  Aktuell:
                  <a class="admin-media-picker__preview-link" href="<%= localeData(newsPageData, lang.key)?.newsletter?.imageSrc %>" target="_blank" rel="noopener noreferrer" data-media-preview-url="<%= localeData(newsPageData, lang.key)?.newsletter?.imageSrc %>" title="<%= localeData(newsPageData, lang.key)?.newsletter?.imageSrc %>">
                    <%= truncateText(localeData(newsPageData, lang.key)?.newsletter?.imageSrc) %>
                  </a>
                  <% } else { %>
                  Keine Datei ausgewählt.
                  <% } %>
                </small>
              </div>
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Bild Alt <%= lang.label %>:</label>
              <input type="text" name="news_<%= lang.key %>_newsletter_image_alt" value="<%= safeValue(localeData(newsPageData, lang.key)?.newsletter?.imageAlt) %>" placeholder="Alt Text...">
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__actions">
          <button type="submit" class="admin-button">Speichern ✓</button>
        </div>
      </form>

            <form class="admin-panel is-hidden" method="post" action="/adminbackend/rahmenplan" enctype="multipart/form-data" data-panel="rahmenplan" data-panel-group="pages">
        <div class="admin-panel__section">
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Titel <%= lang.label %>:</label>
              <input type="text" name="rahmenplan_<%= lang.key %>_title" value="<%= safeValue(localeData(rahmenplanPageData, lang.key)?.title) %>" placeholder="Gib den Titel ein...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Meta <%= lang.label %>:</label>
              <input type="text" name="rahmenplan_<%= lang.key %>_meta" value="<%= safeValue(localeData(rahmenplanPageData, lang.key)?.meta) %>" placeholder="Gib die Meta-Description ein...">
            </div>
            <% }) %>
          </div>
        </div>

        <% langs.forEach((lang) => { %>
        <% const downloadItems = localeData(rahmenplanPageData, lang.key)?.downloads || []; %>
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Rahmenplan Inhalte <%= lang.label %></h3>
          <div class="admin-grid">
            <div class="admin-field">
              <label>Überschrift <%= lang.label %>:</label>
              <input type="text" name="rahmenplan_<%= lang.key %>_headline" value="<%= safeValue(localeData(rahmenplanPageData, lang.key)?.headline) %>" placeholder="Gib die Überschrift ein...">
            </div>
          </div>
          <div class="admin-grid">
            <div class="admin-field">
              <label>Kurzbeschreibung <%= lang.label %>:</label>
              <textarea name="rahmenplan_<%= lang.key %>_short_text" placeholder="Gib die Kurzbeschreibung ein..."><%= safeValue(localeData(rahmenplanPageData, lang.key)?.shortText) %></textarea>
            </div>
          </div>
          <div class="admin-grid">
            <div class="admin-field">
              <label>Posterbild (Erste Seite) <%= lang.label %>:</label>
              <div class="admin-media-picker" data-gallery-picker data-gallery-allow="image">
                <div class="admin-media-picker__controls">
                  <button class="admin-button admin-button--secondary" type="button" data-gallery-open>Datei auswählen</button>
                  <button class="admin-button admin-button--secondary" type="button" data-upload-trigger>Datei hochladen</button>
                  <input type="file" name="rahmenplan_<%= lang.key %>_poster_file" accept="image/*" data-upload-input hidden>
                </div>
                <input type="hidden" name="rahmenplan_<%= lang.key %>_poster_gallery_image_id" data-gallery-input="image">
                <small data-gallery-preview>
                  <% if (localeData(rahmenplanPageData, lang.key)?.posterSrc) { %>
                  Aktuell:
                  <a class="admin-media-picker__preview-link" href="<%= localeData(rahmenplanPageData, lang.key)?.posterSrc %>" target="_blank" rel="noopener noreferrer" data-media-preview-url="<%= localeData(rahmenplanPageData, lang.key)?.posterSrc %>" title="<%= localeData(rahmenplanPageData, lang.key)?.posterSrc %>">
                    <%= truncateText(localeData(rahmenplanPageData, lang.key)?.posterSrc) %>
                  </a>
                  <% } else { %>
                  Keine Datei ausgewählt.
                  <% } %>
                </small>
              </div>
            </div>
          </div>
          <div class="admin-grid">
            <div class="admin-field">
              <label>Datei zum Download hinzufügen <%= lang.label %>:</label>
              <div class="admin-downloads" data-rahmenplan-downloads data-locale="<%= lang.key %>">
                <% downloadItems.forEach((item, index) => { const row = index + 1; %>
                <div class="admin-downloads__row" data-download-row>
                  <input type="text" name="rahmenplan_<%= lang.key %>_download_label_<%= row %>" value="<%= safeValue(item.label) %>" placeholder="Buttontext eingeben...">
                  <input type="hidden" name="rahmenplan_<%= lang.key %>_download_url_<%= row %>" value="<%= safeValue(item.url) %>">
                  <input type="file" name="rahmenplan_<%= lang.key %>_download_file_<%= row %>" data-download-file>
                  <% if (item.url) { %>
                  <a class="admin-downloads__preview" href="<%= item.url %>" target="_blank" rel="noopener noreferrer">Aktuell</a>
                  <% } %>
                </div>
                <% }) %>
                <div class="admin-downloads__row" data-download-row>
                  <input type="text" name="rahmenplan_<%= lang.key %>_download_label_<%= downloadItems.length + 1 %>" value="" placeholder="Buttontext eingeben...">
                  <input type="hidden" name="rahmenplan_<%= lang.key %>_download_url_<%= downloadItems.length + 1 %>" value="">
                  <input type="file" name="rahmenplan_<%= lang.key %>_download_file_<%= downloadItems.length + 1 %>" data-download-file>
                </div>
              </div>
              <small>Wenn du eine Datei auswählst, erscheint automatisch ein weiteres Feld.</small>
            </div>
          </div>
          <div class="admin-grid">
            <div class="admin-field">
              <label>Langer Text <%= lang.label %>:</label>
              <textarea name="rahmenplan_<%= lang.key %>_long_text" placeholder="Gib den langen Text ein..."><%= safeValue(localeData(rahmenplanPageData, lang.key)?.longText) %></textarea>
            </div>
          </div>
        </div>
        <% }) %>

        <div class="admin-panel__actions">
          <button type="submit" class="admin-button">Speichern ✓</button>
        </div>
      </form>

      <form class="admin-panel is-hidden" method="post" action="/adminbackend/gallery-page" data-panel="gallery" data-panel-group="pages">
        <div class="admin-panel__section">
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Titel <%= lang.label %>:</label>
              <input type="text" name="gallery_<%= lang.key %>_title" value="<%= safeValue(localeData(galleryPageData, lang.key)?.title) %>" placeholder="Gib den Titel ein...">
            </div>
            <% }) %>
          </div>

          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Meta <%= lang.label %>:</label>
              <input type="text" name="gallery_<%= lang.key %>_meta" value="<%= safeValue(localeData(galleryPageData, lang.key)?.meta) %>" placeholder="Gib die Meta-Description ein...">
            </div>
            <% }) %>
          </div>

          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Überschrift <%= lang.label %>:</label>
              <input type="text" name="gallery_<%= lang.key %>_headline" value="<%= safeValue(localeData(galleryPageData, lang.key)?.headline) %>" placeholder="Gib die Überschrift ein...">
            </div>
            <% }) %>
          </div>

          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Text <%= lang.label %>:</label>
              <input type="text" name="gallery_<%= lang.key %>_text" value="<%= safeValue(localeData(galleryPageData, lang.key)?.text) %>" placeholder="Gib den Text ein...">
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__actions">
          <button type="submit" class="admin-button">Gallery speichern ✓</button>
          <a class="admin-button" href="/adminbackend?tab=gallery">Admin Gallery öffnen</a>
        </div>
      </form>

      <form class="admin-panel is-hidden" method="post" action="/adminbackend/videos" data-panel="videos" data-panel-group="pages">
        <div class="admin-panel__section">
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Titel <%= lang.label %>:</label>
              <input type="text" name="video_<%= lang.key %>_title" value="<%= safeValue(localeData(videoMetaData, lang.key)?.title) %>" placeholder="Gib den Titel ein...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Meta <%= lang.label %>:</label>
              <input type="text" name="video_<%= lang.key %>_meta" value="<%= safeValue(localeData(videoMetaData, lang.key)?.meta) %>" placeholder="Gib die Meta-Description ein...">
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Video-Seite (Hero & Kategorien):</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Hero Auswahl <%= lang.label %>:</label>
              <select name="<%= lang.key %>_video_hero_mode">
                <% heroModes.forEach((mode) => { %>
                <option value="<%= mode.value %>" <%= localeData(videoPageData, lang.key)?.heroMode === mode.value ? 'selected' : '' %>>
                  <%= mode.label %>
                </option>
                <% }) %>
              </select>
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Hero Video <%= lang.label %>:</label>
              <select name="<%= lang.key %>_video_hero_id">
                <option value="">—</option>
                <% (videoOptionsByLocale?.[lang.key] || []).forEach((video) => { %>
                <option value="<%= video.id %>" <%= String(localeData(videoPageData, lang.key)?.heroVideoId || '') === String(video.id) ? 'selected' : '' %>>
                  <%= video.title %>
                </option>
                <% }) %>
              </select>
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Kategorien Reihenfolge <%= lang.label %> (Komma-getrennt):</label>
              <input type="text" name="<%= lang.key %>_video_categories" value="<%= safeValue((localeData(videoPageData, lang.key)?.categories || []).join(', ')) %>" placeholder="Alle Filme, Fokus, Featured ...">
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__actions">
          <button type="submit" class="admin-button">Speichern ✓</button>
        </div>
      </form>

      <form class="admin-panel is-hidden" method="post" action="/adminbackend/team" data-panel="team" data-panel-group="pages">
        <div class="admin-panel__section">
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Titel <%= lang.label %>:</label>
              <input type="text" name="team_<%= lang.key %>_title" value="<%= safeValue(localeData(teamPageData, lang.key)?.title) %>" placeholder="Gib den Titel ein...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Meta <%= lang.label %>:</label>
              <input type="text" name="team_<%= lang.key %>_meta" value="<%= safeValue(localeData(teamPageData, lang.key)?.meta) %>" placeholder="Gib die Meta-Description ein...">
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Team-Hero:</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Hauptüberschrift <%= lang.label %>:</label>
              <input type="text" name="team_<%= lang.key %>_headline" value="<%= safeValue(localeData(teamPageData, lang.key)?.headline) %>" placeholder="Gib die Überschrift ein...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Unterüberschrift <%= lang.label %>:</label>
              <input type="text" name="team_<%= lang.key %>_subline" value="<%= safeValue(localeData(teamPageData, lang.key)?.subline) %>" placeholder="Gib die Unterüberschrift ein...">
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Über Bereich:</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Über Überschrift <%= lang.label %>:</label>
              <input type="text" name="team_<%= lang.key %>_about_headline" value="<%= safeValue(localeData(teamPageData, lang.key)?.aboutHeadline) %>" placeholder="Gib die Überschrift ein...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Über Text <%= lang.label %>:</label>
              <textarea name="team_<%= lang.key %>_about_text" placeholder="Gib den Über Text ein..."><%= safeValue(localeData(teamPageData, lang.key)?.aboutText) %></textarea>
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__actions">
          <button type="submit" class="admin-button">Speichern ✓</button>
        </div>
      </form>

      <form class="admin-panel is-hidden" method="post" action="/adminbackend/sponsor" data-panel="sponsoren" data-panel-group="pages">
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Meta:</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Meta Titel <%= lang.label %>:</label>
              <input type="text" name="sponsor_<%= lang.key %>_meta_title" value="<%= safeValue(localeData(sponsorPageData, lang.key)?.metaTitle) %>" placeholder="Meta Titel eingeben...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Meta Description <%= lang.label %>:</label>
              <input type="text" name="sponsor_<%= lang.key %>_meta" value="<%= safeValue(localeData(sponsorPageData, lang.key)?.meta) %>" placeholder="Meta Description eingeben...">
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Seiten-Header:</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Titel <%= lang.label %>:</label>
              <input type="text" name="sponsor_<%= lang.key %>_title" value="<%= safeValue(localeData(sponsorPageData, lang.key)?.heroTitle) %>" placeholder="Titel eingeben...">
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__actions">
          <button type="submit" class="admin-button">Speichern ✓</button>
        </div>
      </form>

      <form class="admin-panel is-hidden" method="post" action="/adminbackend/team-members" enctype="multipart/form-data" data-panel="team" data-panel-group="pages">
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Neues Teammitglied:</h3>
          <div class="admin-grid">
            <div class="admin-field">
              <label>Name:</label>
              <input type="text" name="team_member_name" placeholder="Name eingeben..." required>
            </div>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Rolle <%= lang.label %>:</label>
              <input type="text" name="team_member_role_<%= lang.key %>" placeholder="Rolle eingeben...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Beschreibung <%= lang.label %>:</label>
              <textarea name="team_member_description_<%= lang.key %>" placeholder="Beschreibung eingeben..."></textarea>
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <div class="admin-field">
              <label>Bild-Alt-Text:</label>
              <input type="text" name="team_member_image_alt_text" placeholder="Alt-Text eingeben...">
            </div>
            <div class="admin-field">
              <label>Bild:</label>
              <div class="admin-media-picker" data-gallery-picker data-gallery-allow="image">
                <div class="admin-media-picker__controls">
                  <button class="admin-button admin-button--secondary" type="button" data-gallery-open>Datei auswählen</button>
                  <button class="admin-button admin-button--secondary" type="button" data-upload-trigger>Datei hochladen</button>
                  <input type="file" name="team_member_image" accept="image/*" data-upload-input hidden>
                </div>
                <input type="hidden" name="team_member_gallery_image_id" data-gallery-input="image">
                <small data-gallery-preview>Keine Datei ausgewählt.</small>
              </div>
            </div>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field admin-field--checkbox">
              <label class="blass">Display <%= lang.label %>:</label>
              <input type="checkbox" name="team_member_display_<%= lang.key %>" checked>
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__actions">
          <button type="submit" class="admin-button">Teammitglied speichern ✓</button>
        </div>
      </form>

      <section class="admin-panel is-hidden" data-panel="team" data-panel-group="pages">
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Teammitglieder:</h3>
          <div class="admin-team-list">
            <% (teamMembers || []).forEach((member) => { %>
            <div class="admin-team-card">
              <div class="admin-team-card__info">
                <% if (member.image_url) { %>
                <img src="<%= member.image_url %>" alt="<%= member.image_alt_text || member.name %>">
                <% } %>
                <div>
                  <strong><%= member.name %></strong>
                  <% langs.forEach((lang) => { %>
                  <span><%= lang.label %>: <%= member.locales?.[lang.key]?.role || '' %></span>
                  <% }) %>
                </div>
              </div>
              <div class="admin-team-card__actions">
                <% langs.forEach((lang) => { %>
                <form method="post" action="/adminbackend/team-members/<%= member.id %>/display">
                  <input type="hidden" name="locale" value="<%= lang.key %>">
                  <label class="blass">Display <%= lang.label %></label>
                  <input type="checkbox" name="display" <%= member.locales?.[lang.key]?.display ? 'checked' : '' %>>
                  <button type="submit" class="admin-button">Speichern ✓</button>
                </form>
                <% }) %>
                <form method="post" action="/adminbackend/team-members/<%= member.id %>/delete">
                  <button type="submit" class="admin-button admin-button--danger">Löschen</button>
                </form>
              </div>
              <details class="admin-team-card__edit">
                <summary class="admin-button admin-button--secondary">Bearbeiten</summary>
                <form method="post" action="/adminbackend/team-members/<%= member.id %>/update" enctype="multipart/form-data">
                  <div class="admin-grid">
                    <div class="admin-field">
                      <label>Name:</label>
                      <input type="text" name="team_member_name" value="<%= safeValue(member.name) %>" required>
                    </div>
                  </div>
                  <div class="admin-grid">
                    <% langs.forEach((lang) => { %>
                    <div class="admin-field">
                      <label>Rolle <%= lang.label %>:</label>
                      <input type="text" name="team_member_role_<%= lang.key %>" value="<%= safeValue(member.locales?.[lang.key]?.role) %>">
                    </div>
                    <% }) %>
                  </div>
                  <div class="admin-grid">
                    <% langs.forEach((lang) => { %>
                    <div class="admin-field">
                      <label>Beschreibung <%= lang.label %>:</label>
                      <textarea name="team_member_description_<%= lang.key %>"><%= safeValue(member.locales?.[lang.key]?.description) %></textarea>
                    </div>
                    <% }) %>
                  </div>
                  <div class="admin-grid">
                    <div class="admin-field">
                      <label>Bild-Alt-Text:</label>
                      <input type="text" name="team_member_image_alt_text" value="<%= safeValue(member.image_alt_text) %>">
                    </div>
                    <div class="admin-field">
                      <label>Bild:</label>
                      <div class="admin-media-picker" data-gallery-picker data-gallery-allow="image">
                        <div class="admin-media-picker__controls">
                          <button class="admin-button admin-button--secondary" type="button" data-gallery-open>Datei auswählen</button>
                          <button class="admin-button admin-button--secondary" type="button" data-upload-trigger>Datei hochladen</button>
                          <input type="file" name="team_member_image" accept="image/*" data-upload-input hidden>
                        </div>
                        <input type="hidden" name="team_member_gallery_image_id" data-gallery-input="image">
                        <input type="hidden" name="team_member_existing_image" value="<%= safeValue(member.image_url) %>">
                        <small data-gallery-preview><%= member.image_url ? 'Bild vorhanden.' : 'Keine Datei ausgewählt.' %></small>
                      </div>
                    </div>
                  </div>
                  <div class="admin-grid">
                    <% langs.forEach((lang) => { %>
                    <div class="admin-field admin-field--checkbox">
                      <label class="blass">Display <%= lang.label %>:</label>
                      <input type="checkbox" name="team_member_display_<%= lang.key %>" <%= member.locales?.[lang.key]?.display ? 'checked' : '' %>>
                    </div>
                    <% }) %>
                  </div>
                  <div class="admin-panel__actions">
                    <button type="submit" class="admin-button">Änderungen speichern ✓</button>
                  </div>
                </form>
              </details>
            </div>
            <% }) %>
            <% if (!teamMembers || !teamMembers.length) { %>
            <p class="admin-empty">Keine Teammitglieder vorhanden.</p>
            <% } %>
          </div>
        </div>
      </section>

      <form class="admin-panel is-hidden" method="post" action="/adminbackend/tickets" enctype="multipart/form-data" data-panel="kinotickets" data-panel-group="pages">
        <div class="admin-panel__section">
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Titel <%= lang.label %>:</label>
              <input type="text" name="tickets_<%= lang.key %>_title" value="<%= safeValue(localeData(ticketsPageData, lang.key)?.title) %>" placeholder="Gib den Titel ein...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Meta <%= lang.label %>:</label>
              <input type="text" name="tickets_<%= lang.key %>_meta" value="<%= safeValue(localeData(ticketsPageData, lang.key)?.meta) %>" placeholder="Gib die Meta-Description ein...">
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Hero Bereich:</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>H1 <%= lang.label %>:</label>
              <input type="text" name="tickets_<%= lang.key %>_h1" value="<%= safeValue(localeData(ticketsPageData, lang.key)?.h1) %>" placeholder="Gib den Titel ein...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Subline <%= lang.label %>:</label>
              <input type="text" name="tickets_<%= lang.key %>_subline" value="<%= safeValue(localeData(ticketsPageData, lang.key)?.subline) %>" placeholder="Gib die Subline ein...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Fokus <%= lang.label %>:</label>
              <input type="text" name="tickets_<%= lang.key %>_focus" value="<%= safeValue(localeData(ticketsPageData, lang.key)?.focus) %>" placeholder="Gib den Fokus ein...">
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Hero Bild Kino:</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <% const settings = ticketSettings(lang.key).kino || {}; %>
            <div class="admin-field">
              <label>Hero-Bild <%= lang.label %>:</label>
              <div class="admin-media-picker" data-gallery-picker data-gallery-allow="image">
                <div class="admin-media-picker__controls">
                  <button class="admin-button admin-button--secondary" type="button" data-gallery-open>Datei auswählen</button>
                  <button class="admin-button admin-button--secondary" type="button" data-upload-trigger>Datei hochladen</button>
                  <input type="file" name="tickets_<%= lang.key %>_hero_kino" accept="image/*" data-upload-input hidden>
                </div>
                <input type="hidden" name="tickets_<%= lang.key %>_hero_kino_gallery_image_id" data-gallery-input="image">
                <small data-gallery-preview>
                  <% if (settings.heroImageSrc) { %>
                  Aktuell:
                  <a class="admin-media-picker__preview-link" href="<%= settings.heroImageSrc %>" target="_blank" rel="noopener noreferrer" data-media-preview-url="<%= settings.heroImageSrc %>" title="<%= settings.heroImageSrc %>">
                    <%= truncateText(settings.heroImageSrc) %>
                  </a>
                  <% } else { %>
                  Keine Datei ausgewählt.
                  <% } %>
                </small>
              </div>
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Tickets anzeigen (Kino):</h3>
          <% langs.forEach((lang) => { %>
          <% const options = ticketOptionList(lang.key); %>
          <% const visibility = ticketVisibilityMap(lang.key); %>
          <div class="admin-panel__subsection">
            <h4 class="admin-panel__subtitle"><%= lang.label %></h4>
            <div class="admin-grid">
              <% options.forEach((ticket) => { %>
              <% const defaultShow = ['kino', 'combo'].includes(ticket.ticket_type); %>
              <% const showKino = visibility?.[ticket.id]?.showKino ?? defaultShow; %>
              <div class="admin-field admin-field--checkbox">
                <label class="blass"><%= ticket.title %></label>
                <input type="checkbox" name="tickets_<%= lang.key %>_ticket_kino_<%= ticket.id %>" <%= isChecked(showKino) %>>
              </div>
              <% }) %>
            </div>
            <% if (!options.length) { %>
            <p class="admin-empty">Keine Tickets vorhanden.</p>
            <% } %>
          </div>
          <% }) %>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Featured Video (Kino):</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <% const settings = ticketSettings(lang.key).kino || {}; %>
            <div class="admin-field">
              <label>Modus <%= lang.label %>:</label>
              <select name="tickets_<%= lang.key %>_kino_featured_mode">
                <% heroModes.forEach((mode) => { %>
                <option value="<%= mode.value %>" <%= isSelected(settings.featuredMode, mode.value) %>><%= mode.label %></option>
                <% }) %>
              </select>
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <% const settings = ticketSettings(lang.key).kino || {}; %>
            <% const options = videoOptions(lang.key); %>
            <div class="admin-field">
              <label>Video auswählen <%= lang.label %>:</label>
              <select name="tickets_<%= lang.key %>_kino_featured_video">
                <option value="">—</option>
                <% options.forEach((video) => { %>
                <option value="<%= video.id %>" <%= isSelected(settings.featuredVideoId, video.id) %>><%= video.title %></option>
                <% }) %>
              </select>
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Kino diese Woche:</h3>
          <% langs.forEach((lang) => { %>
          <% const settings = ticketSettings(lang.key).kino || {}; %>
          <% const options = videoOptions(lang.key); %>
          <div class="admin-panel__subsection">
            <h4 class="admin-panel__subtitle"><%= lang.label %></h4>
            <div class="admin-grid">
              <% options.forEach((video) => { %>
              <div class="admin-field admin-field--checkbox">
                <label class="blass"><%= video.title %></label>
                <input type="checkbox" name="tickets_<%= lang.key %>_kino_now_playing_ids" value="<%= video.id %>" <%= isChecked(settings.nowPlayingIds?.includes(video.id)) %>>
              </div>
              <% }) %>
            </div>
            <% if (!options.length) { %>
            <p class="admin-empty">Keine Videos vorhanden.</p>
            <% } %>
          </div>
          <% }) %>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Demnächst im Kino:</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <% const settings = ticketSettings(lang.key).kino || {}; %>
            <div class="admin-field">
              <label>Startdatum <%= lang.label %>:</label>
              <input type="text" name="tickets_<%= lang.key %>_kino_upcoming_date" value="<%= safeValue(settings.upcomingDate) %>" placeholder="z.B. 18.09.2026">
            </div>
            <% }) %>
          </div>
          <% langs.forEach((lang) => { %>
          <% const settings = ticketSettings(lang.key).kino || {}; %>
          <% const options = videoOptions(lang.key); %>
          <div class="admin-panel__subsection">
            <h4 class="admin-panel__subtitle"><%= lang.label %></h4>
            <div class="admin-grid">
              <% options.forEach((video) => { %>
              <div class="admin-field admin-field--checkbox">
                <label class="blass"><%= video.title %></label>
                <input type="checkbox" name="tickets_<%= lang.key %>_kino_upcoming_ids" value="<%= video.id %>" <%= isChecked(settings.upcomingIds?.includes(video.id)) %>>
              </div>
              <% }) %>
            </div>
            <% if (!options.length) { %>
            <p class="admin-empty">Keine Videos vorhanden.</p>
            <% } %>
          </div>
          <% }) %>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Beschreibung:</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Text <%= lang.label %>:</label>
              <input type="text" name="tickets_<%= lang.key %>_description" value="<%= safeValue(localeData(ticketsPageData, lang.key)?.description) %>" placeholder="Gib die Beschreibung ein...">
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">FAQ Bereich:</h3>
          <% faqRows.forEach((row) => { %>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Frage <%= row %> <%= lang.label %>:</label>
              <input type="text" name="tickets_<%= lang.key %>_faq_q<%= row %>" value="<%= safeValue(localeData(ticketsPageData, lang.key)?.faq?.[row - 1]?.question) %>" placeholder="Gib die Frage ein...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Antwort <%= row %> <%= lang.label %>:</label>
              <input type="text" name="tickets_<%= lang.key %>_faq_a<%= row %>" value="<%= safeValue(localeData(ticketsPageData, lang.key)?.faq?.[row - 1]?.answer) %>" placeholder="Gib die Antwort ein...">
            </div>
            <% }) %>
          </div>
          <% }) %>
        </div>

        <div class="admin-panel__actions">
          <button type="submit" class="admin-button">Speichern ✓</button>
        </div>
      </form>

      <form class="admin-panel is-hidden" method="post" action="/adminbackend/online-tickets" enctype="multipart/form-data" data-panel="onlinetickets" data-panel-group="pages">
        <div class="admin-panel__section">
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Titel <%= lang.label %>:</label>
              <input type="text" name="online_<%= lang.key %>_title" value="<%= safeValue(localeData(onlineTicketsPageData, lang.key)?.title) %>" placeholder="Gib den Titel ein...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Meta <%= lang.label %>:</label>
              <input type="text" name="online_<%= lang.key %>_meta" value="<%= safeValue(localeData(onlineTicketsPageData, lang.key)?.meta) %>" placeholder="Gib die Meta-Description ein...">
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Hero Bereich:</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>H1 <%= lang.label %>:</label>
              <input type="text" name="online_<%= lang.key %>_h1" value="<%= safeValue(localeData(onlineTicketsPageData, lang.key)?.h1) %>" placeholder="Gib den Titel ein...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Subline <%= lang.label %>:</label>
              <input type="text" name="online_<%= lang.key %>_subline" value="<%= safeValue(localeData(onlineTicketsPageData, lang.key)?.subline) %>" placeholder="Gib die Subline ein...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Fokus <%= lang.label %>:</label>
              <input type="text" name="online_<%= lang.key %>_focus" value="<%= safeValue(localeData(onlineTicketsPageData, lang.key)?.focus) %>" placeholder="Gib den Fokus ein...">
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Hero Bild Online:</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <% const settings = ticketSettings(lang.key).online || {}; %>
            <div class="admin-field">
              <label>Hero-Bild <%= lang.label %>:</label>
              <div class="admin-media-picker" data-gallery-picker data-gallery-allow="image">
                <div class="admin-media-picker__controls">
                  <button class="admin-button admin-button--secondary" type="button" data-gallery-open>Datei auswählen</button>
                  <button class="admin-button admin-button--secondary" type="button" data-upload-trigger>Datei hochladen</button>
                  <input type="file" name="online_<%= lang.key %>_hero_online" accept="image/*" data-upload-input hidden>
                </div>
                <input type="hidden" name="online_<%= lang.key %>_hero_online_gallery_image_id" data-gallery-input="image">
                <small data-gallery-preview>
                  <% if (settings.heroImageSrc) { %>
                  Aktuell:
                  <a class="admin-media-picker__preview-link" href="<%= settings.heroImageSrc %>" target="_blank" rel="noopener noreferrer" data-media-preview-url="<%= settings.heroImageSrc %>" title="<%= settings.heroImageSrc %>">
                    <%= truncateText(settings.heroImageSrc) %>
                  </a>
                  <% } else { %>
                  Keine Datei ausgewählt.
                  <% } %>
                </small>
              </div>
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Tickets anzeigen (Online):</h3>
          <% langs.forEach((lang) => { %>
          <% const options = ticketOptionList(lang.key); %>
          <% const visibility = ticketVisibilityMap(lang.key); %>
          <div class="admin-panel__subsection">
            <h4 class="admin-panel__subtitle"><%= lang.label %></h4>
            <div class="admin-grid">
              <% options.forEach((ticket) => { %>
              <% const defaultShow = ['online', 'combo'].includes(ticket.ticket_type); %>
              <% const showOnline = visibility?.[ticket.id]?.showOnline ?? defaultShow; %>
              <div class="admin-field admin-field--checkbox">
                <label class="blass"><%= ticket.title %></label>
                <input type="checkbox" name="online_<%= lang.key %>_ticket_online_<%= ticket.id %>" <%= isChecked(showOnline) %>>
              </div>
              <% }) %>
            </div>
            <% if (!options.length) { %>
            <p class="admin-empty">Keine Tickets vorhanden.</p>
            <% } %>
          </div>
          <% }) %>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Featured Video (Online):</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <% const settings = ticketSettings(lang.key).online || {}; %>
            <div class="admin-field">
              <label>Modus <%= lang.label %>:</label>
              <select name="online_<%= lang.key %>_online_featured_mode">
                <% heroModes.forEach((mode) => { %>
                <option value="<%= mode.value %>" <%= isSelected(settings.featuredMode, mode.value) %>><%= mode.label %></option>
                <% }) %>
              </select>
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <% const settings = ticketSettings(lang.key).online || {}; %>
            <% const options = videoOptions(lang.key); %>
            <div class="admin-field">
              <label>Video auswählen <%= lang.label %>:</label>
              <select name="online_<%= lang.key %>_online_featured_video">
                <option value="">—</option>
                <% options.forEach((video) => { %>
                <option value="<%= video.id %>" <%= isSelected(settings.featuredVideoId, video.id) %>><%= video.title %></option>
                <% }) %>
              </select>
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Online Videos:</h3>
          <% langs.forEach((lang) => { %>
          <% const settings = ticketSettings(lang.key).online || {}; %>
          <% const options = videoOptions(lang.key); %>
          <div class="admin-panel__subsection">
            <h4 class="admin-panel__subtitle"><%= lang.label %></h4>
            <div class="admin-grid">
              <% options.forEach((video) => { %>
              <div class="admin-field admin-field--checkbox">
                <label class="blass"><%= video.title %></label>
                <input type="checkbox" name="online_<%= lang.key %>_online_video_ids" value="<%= video.id %>" <%= isChecked(settings.videoIds?.includes(video.id)) %>>
              </div>
              <% }) %>
            </div>
            <% if (!options.length) { %>
            <p class="admin-empty">Keine Videos vorhanden.</p>
            <% } %>
          </div>
          <% }) %>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Beschreibung:</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Text <%= lang.label %>:</label>
              <input type="text" name="online_<%= lang.key %>_description" value="<%= safeValue(localeData(onlineTicketsPageData, lang.key)?.description) %>" placeholder="Gib die Beschreibung ein...">
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">FAQ Bereich:</h3>
          <% faqRows.forEach((row) => { %>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Frage <%= row %> <%= lang.label %>:</label>
              <input type="text" name="online_<%= lang.key %>_faq_q<%= row %>" value="<%= safeValue(localeData(onlineTicketsPageData, lang.key)?.faq?.[row - 1]?.question) %>" placeholder="Gib die Frage ein...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Antwort <%= row %> <%= lang.label %>:</label>
              <input type="text" name="online_<%= lang.key %>_faq_a<%= row %>" value="<%= safeValue(localeData(onlineTicketsPageData, lang.key)?.faq?.[row - 1]?.answer) %>" placeholder="Gib die Antwort ein...">
            </div>
            <% }) %>
          </div>
          <% }) %>
        </div>

        <div class="admin-panel__actions">
          <button type="submit" class="admin-button">Speichern ✓</button>
        </div>
      </form>

      <form class="admin-panel is-hidden" method="post" action="/adminbackend/spenden" data-panel="spenden" data-panel-group="pages">
        <div class="admin-panel__section">
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Titel <%= lang.label %>:</label>
              <input type="text" name="spenden_<%= lang.key %>_title" value="<%= safeValue(localeData(donationPageData, lang.key)?.title) %>" placeholder="Gib den Titel ein...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Meta <%= lang.label %>:</label>
              <input type="text" name="spenden_<%= lang.key %>_meta" value="<%= safeValue(localeData(donationPageData, lang.key)?.meta) %>" placeholder="Gib die Meta-Description ein...">
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Spenden Inhalte:</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Überschrift <%= lang.label %>:</label>
              <input type="text" name="spenden_<%= lang.key %>_headline" value="<%= safeValue(localeData(donationPageData, lang.key)?.headline) %>" placeholder="Gib die Überschrift ein...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Beschreibung <%= lang.label %>:</label>
              <input type="text" name="spenden_<%= lang.key %>_description" value="<%= safeValue(localeData(donationPageData, lang.key)?.description) %>" placeholder="Gib die Beschreibung ein...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Titel Betragsauswahl <%= lang.label %>:</label>
              <input type="text" name="spenden_<%= lang.key %>_amount_title" value="<%= safeValue(localeData(donationPageData, lang.key)?.amountTitle) %>" placeholder="z.B. Wähle deinen Betrag...">
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-grid">
          <% langs.forEach((lang) => { %>
          <div class="admin-field">
            <label>Label Eigener Betrag <%= lang.label %>:</label>
            <input type="text" name="spenden_<%= lang.key %>_custom_label" value="<%= safeValue(localeData(donationPageData, lang.key)?.customLabel) %>" placeholder="z.B. Eigener Betrag">
          </div>
          <% }) %>
        </div>
        <div class="admin-grid">
          <% langs.forEach((lang) => { %>
          <div class="admin-field">
            <label>Platzhalter Eigener Betrag <%= lang.label %>:</label>
            <input type="text" name="spenden_<%= lang.key %>_custom_placeholder" value="<%= safeValue(localeData(donationPageData, lang.key)?.customPlaceholder) %>" placeholder="z.B. Betrag eingeben...">
          </div>
          <% }) %>
        </div>
        <div class="admin-grid">
          <% langs.forEach((lang) => { %>
          <div class="admin-field">
            <label>Titel Persönliche Angaben <%= lang.label %>:</label>
            <input type="text" name="spenden_<%= lang.key %>_personal_title" value="<%= safeValue(localeData(donationPageData, lang.key)?.personalTitle) %>" placeholder="z.B. Persönliche Angaben">
          </div>
          <% }) %>
        </div>
        <div class="admin-grid">
          <% langs.forEach((lang) => { %>
          <div class="admin-field">
            <label>Vorname Label <%= lang.label %>:</label>
            <input type="text" name="spenden_<%= lang.key %>_first_name" value="<%= safeValue(localeData(donationPageData, lang.key)?.firstNameLabel) %>" placeholder="z.B. Vorname">
          </div>
          <% }) %>
        </div>
        <div class="admin-grid">
          <% langs.forEach((lang) => { %>
          <div class="admin-field">
            <label>Nachname Label <%= lang.label %>:</label>
            <input type="text" name="spenden_<%= lang.key %>_last_name" value="<%= safeValue(localeData(donationPageData, lang.key)?.lastNameLabel) %>" placeholder="z.B. Nachname">
          </div>
          <% }) %>
        </div>
        <div class="admin-grid">
          <% langs.forEach((lang) => { %>
          <div class="admin-field">
            <label>Email Label <%= lang.label %>:</label>
            <input type="text" name="spenden_<%= lang.key %>_email" value="<%= safeValue(localeData(donationPageData, lang.key)?.emailLabel) %>" placeholder="z.B. E-Mail">
          </div>
          <% }) %>
        </div>
        <div class="admin-grid">
          <% langs.forEach((lang) => { %>
          <div class="admin-field">
            <label>Spenden Button <%= lang.label %>:</label>
            <input type="text" name="spenden_<%= lang.key %>_submit" value="<%= safeValue(localeData(donationPageData, lang.key)?.submitLabel) %>" placeholder="z.B. Spenden">
          </div>
          <% }) %>
        </div>
        <div class="admin-grid">
          <% langs.forEach((lang) => { %>
          <div class="admin-field">
            <label>Abschlusstext <%= lang.label %>:</label>
            <input type="text" name="spenden_<%= lang.key %>_closing" value="<%= safeValue(localeData(donationPageData, lang.key)?.closingText) %>" placeholder="z.B. Spendenquittung...">
          </div>
          <% }) %>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Spendenbeträge (max. 5):</h3>
          <% donationAmountRows.forEach((row) => { %>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Betrag <%= row %> <%= lang.label %>:</label>
              <input type="number" name="spenden_<%= lang.key %>_amount_<%= row %>" value="<%= safeValue(localeData(donationPageData, lang.key)?.amounts?.[row - 1]?.value) %>" placeholder="z.B. 25">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field admin-field--checkbox">
              <label class="blass">Aktiv:</label>
              <input type="checkbox" name="spenden_<%= lang.key %>_amount_<%= row %>_enabled" <%= isChecked(localeData(donationPageData, lang.key)?.amounts?.[row - 1]?.enabled) %>>
            </div>
            <% }) %>
          </div>
          <% }) %>
        </div>

        <div class="admin-panel__actions">
          <button type="submit" class="admin-button">Speichern ✓</button>
        </div>
      </form>
    </div>
    <div class="admin-content__section is-hidden" data-nav-content="newsletter">
      <header class="admin-content__header">
        <h2>Newsletter Backend</h2>
        <p>Hier siehst du alle Anmeldungen und kannst Newsletter an Abonnenten versenden.</p>
        <div class="admin-tabs" data-admin-tabs="newsletter">
          <button class="admin-tab <%= newsletterTab === 'overview' ? 'is-active' : '' %>" type="button" data-tab="overview">
            Anmeldungen
          </button>
          <button class="admin-tab <%= newsletterTab === 'compose' ? 'is-active' : '' %>" type="button" data-tab="compose">
            Newsletter erstellen
          </button>
          <button class="admin-tab <%= newsletterTab === 'footer' ? 'is-active' : '' %>" type="button" data-tab="footer">
            Fußnote
          </button>
        </div>
      </header>

      <div class="admin-panel <%= newsletterTab === 'overview' ? '' : 'is-hidden' %>" data-panel="overview" data-panel-group="newsletter">
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Alle Newsletter Anmeldungen</h3>
          <% if (!newsletterSubscriptions || newsletterSubscriptions.length === 0) { %>
          <p class="admin-empty">Noch keine Newsletter-Anmeldungen vorhanden.</p>
          <% } else { %>
          <div class="admin-newsletter-table__wrapper">
            <table class="admin-newsletter-table">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Datum</th>
                  <th>E-Mail</th>
                  <th>Artikel</th>
                  <th>Video</th>
                  <th>Aktiv</th>
                  <th>Sprache</th>
                </tr>
              </thead>
              <tbody>
                <% newsletterSubscriptions.forEach((entry) => { %>
                <tr>
                  <td><%= entry.id %></td>
                  <td><%= formatDateTime(entry.created_at) %></td>
                  <td><%= entry.email %></td>
                  <td><%= formatBool(entry.wants_news) %></td>
                  <td><%= formatBool(entry.wants_video) %></td>
                  <td><%= formatBool(entry.active) %></td>
                  <td><%= entry.language || 'de' %></td>
                </tr>
                <% }) %>
              </tbody>
            </table>
          </div>
          <% } %>
        </div>
      </div>

      <form class="admin-panel <%= newsletterTab === 'compose' ? '' : 'is-hidden' %>" method="post" action="/adminbackend/newsletter/send" data-panel="compose" data-panel-group="newsletter">
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Newsletter erstellen</h3>
          <% if (newsletterError === 'missing') { %>
          <div class="admin-panel__alert admin-panel__alert--error">Bitte Titel, Inhalt und mindestens eine Zielgruppe auswählen.</div>
          <% } else if (newsletterError === 'recipients') { %>
          <div class="admin-panel__alert admin-panel__alert--error">Keine passenden Abonnenten gefunden.</div>
          <% } else if (newsletterStatus === 'sent') { %>
          <div class="admin-panel__alert admin-panel__alert--success">Newsletter wurde an <%= newsletterCount %> Empfänger gesendet.</div>
          <% } else if (newsletterStatus === 'partial') { %>
          <div class="admin-panel__alert admin-panel__alert--error">
            Newsletter teilweise versendet: <%= newsletterCount %> erfolgreich, <%= newsletterErrors %> fehlgeschlagen.
          </div>
          <% } %>
          <div class="admin-grid admin-grid--single">
            <div class="admin-field">
              <label>Titel</label>
              <input type="text" name="newsletter_title" placeholder="Gib den Titel ein..." required>
            </div>
          </div>
          <div class="admin-grid admin-grid--single">
            <div class="admin-field">
              <label>Inhalt (HTML oder Text)</label>
              <textarea name="newsletter_content" rows="8" placeholder="Schreibe deinen Newsletter. Links kannst du direkt einfügen oder als HTML verwenden." required></textarea>
              <small>Zeilenumbrüche werden automatisch formatiert. URLs werden als Links erkannt.</small>
            </div>
          </div>
          <div class="admin-grid admin-grid--single">
            <div class="admin-field">
              <label>Sprache</label>
              <select name="newsletter_language" required>
                <option value="de-DE">Deutsch</option>
                <option value="en-US">Englisch</option>
                <option value="ku">Kurdisch</option>
              </select>
            </div>
          </div>
          <div class="admin-grid admin-grid--single">
            <div class="admin-field admin-field--checkbox">
              <input type="checkbox" id="newsletter-articles" name="newsletter_articles" checked>
              <label for="newsletter-articles">Artikel-News Abonnenten</label>
            </div>
            <div class="admin-field admin-field--checkbox">
              <input type="checkbox" id="newsletter-videos" name="newsletter_videos" checked>
              <label for="newsletter-videos">Video-News Abonnenten</label>
            </div>
          </div>
          <div class="admin-panel__actions">
            <button class="admin-button" type="submit">Newsletter versenden</button>
          </div>
        </div>
      </form>

      <form class="admin-panel <%= newsletterTab === 'footer' ? '' : 'is-hidden' %>" method="post" action="/adminbackend/newsletter/footer" enctype="multipart/form-data" data-panel="footer" data-panel-group="newsletter">
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Fußnote konfigurieren</h3>
          <% if (newsletterFooterSaved) { %>
          <div class="admin-panel__alert admin-panel__alert--success">Die Fußnote wurde gespeichert.</div>
          <% } %>
          <div class="admin-grid admin-grid--single">
            <div class="admin-field">
              <label>Fußnoten-Text (HTML möglich)</label>
              <textarea name="newsletter_footer_text" rows="6" placeholder="Hier kannst du deine Fußnote eingeben."><%= safeValue(newsletterSettings?.footer_html) %></textarea>
              <small>Beispiel: &lt;a href=&quot;https://kurdischesfestival.de&quot;&gt;Website besuchen&lt;/a&gt;</small>
            </div>
          </div>
          <div class="admin-grid">
            <div class="admin-field">
              <label>Logo Datei</label>
              <input type="file" name="newsletter_footer_logo" accept="image/*">
              <% if (newsletterSettings?.footer_logo_url) { %>
              <small>Aktuell: <a href="<%= newsletterSettings.footer_logo_url %>" target="_blank" rel="noopener noreferrer">Logo ansehen</a></small>
              <% } %>
            </div>
            <div class="admin-field">
              <label>Logo URL (optional)</label>
              <input type="text" name="newsletter_footer_logo_url" value="<%= safeValue(newsletterSettings?.footer_logo_url) %>" placeholder="https://...">
              <small>Überschreibt das hochgeladene Logo.</small>
            </div>
            <div class="admin-field">
              <label>Logo Alt-Text</label>
              <input type="text" name="newsletter_footer_logo_alt" value="<%= safeValue(newsletterSettings?.footer_logo_alt) %>" placeholder="Alt-Text für das Logo">
            </div>
          </div>
          <div class="admin-grid admin-grid--single">
            <div class="admin-field admin-field--checkbox">
              <input type="checkbox" id="newsletter-logo-remove" name="newsletter_footer_logo_remove">
              <label for="newsletter-logo-remove">Logo entfernen</label>
            </div>
          </div>
          <div class="admin-panel__actions">
            <button class="admin-button" type="submit">Fußnote speichern</button>
          </div>
        </div>
      </form>
    </div>

    <div class="admin-content__section is-hidden" data-nav-content="articles">
      <header class="admin-content__header">
        <h2>Artikel</h2>
        <p>Lege neue News-Artikel an, bearbeite bestehende Einträge oder lösche sie.</p>
        <div class="admin-tabs" data-admin-tabs="articles">
          <button class="admin-tab <%= articlesTab === 'create' ? 'is-active' : '' %>" type="button" data-tab="create">Artikel hinzufügen</button>
          <button class="admin-tab <%= articlesTab === 'edit' ? 'is-active' : '' %>" type="button" data-tab="edit">Artikel bearbeiten</button>
          <button class="admin-tab <%= articlesTab === 'delete' ? 'is-active' : '' %>" type="button" data-tab="delete">Artikel löschen</button>
        </div>
      </header>
      <% if (adminError === 'article-required' && articlesTab === 'create') { %>
      <div class="admin-panel__alert admin-panel__alert--error">
        Bitte fülle alle Pflichtfelder für: <%= adminMissing || 'die ausgewählten Sprachen' %>.
      </div>
      <% } else if (adminError === 'article-empty' && articlesTab === 'create') { %>
      <div class="admin-panel__alert admin-panel__alert--error">
        Bitte fülle mindestens eine Sprache vollständig aus.
      </div>
      <% } else if (adminError === 'article-media' && articlesTab === 'create') { %>
      <div class="admin-panel__alert admin-panel__alert--error">
        Bitte wähle ein Bild oder Video für den Einleitungsbereich.
      </div>
      <% } else if (adminSaved && adminQuery.nav === 'articles' && articlesTab === 'create') { %>
      <div class="admin-panel__alert admin-panel__alert--success">
        Artikel erfolgreich gespeichert.
      </div>
      <% } %>

      <form class="admin-panel <%= articlesTab === 'create' ? '' : 'is-hidden' %>" method="post" action="/adminbackend/articles" enctype="multipart/form-data" data-panel="create" data-panel-group="articles">
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Neuer Artikel</h3>
          <p>Lege neue News-Artikel für Deutsch, Englisch oder Kurdisch an.</p>
        </div>
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Basisdaten</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Titel <%= lang.label %>:</label>
              <input type="text" name="article_<%= lang.key %>_title" placeholder="Titel eingeben...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Meta <%= lang.label %>:</label>
              <input type="text" name="article_<%= lang.key %>_meta" placeholder="Meta-Description eingeben...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>H1 <%= lang.label %>:</label>
              <input type="text" name="article_<%= lang.key %>_h1" placeholder="H1 Titel eingeben...">
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Artikel Einleitung Bereich</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Einleitungs-Titel <%= lang.label %>:</label>
              <input type="text" name="article_<%= lang.key %>_intro_title" placeholder="Einleitungstitel eingeben...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Einleitung Beschreibung <%= lang.label %>:</label>
              <textarea name="article_<%= lang.key %>_intro_description" placeholder="Einleitungsbeschreibung eingeben..."></textarea>
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Bild oder Video <%= lang.label %>:</label>
              <div class="admin-media-picker" data-gallery-picker data-gallery-allow="image video" data-gallery-locale="<%= lang.key %>">
                <div class="admin-media-picker__controls">
                  <button class="admin-button admin-button--secondary" type="button" data-gallery-open>Datei auswählen</button>
                  <button class="admin-button admin-button--secondary" type="button" data-upload-trigger>Datei hochladen</button>
                  <input type="file" name="article_<%= lang.key %>_intro_media" accept="video/*,image/*" data-upload-input hidden>
                </div>
                <input type="hidden" name="article_<%= lang.key %>_intro_gallery_image_id" data-gallery-input="image">
                <input type="hidden" name="article_<%= lang.key %>_intro_gallery_video_id" data-gallery-input="video">
                <small data-gallery-preview>Keine Datei ausgewählt.</small>
              </div>
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Artikel Text</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Überschrift <%= lang.label %>:</label>
              <input type="text" name="article_<%= lang.key %>_body_title" placeholder="Überschrift eingeben...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Artikel Text <%= lang.label %>:</label>
              <textarea name="article_<%= lang.key %>_body_text" placeholder="Artikeltext eingeben..."></textarea>
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Bilder oder Videos hinzufügen (<%= lang.label %>, optional):</label>
              <div class="admin-media-picker" data-gallery-picker data-gallery-allow="image video" data-gallery-mode="multi" data-gallery-locale="<%= lang.key %>">
                <div class="admin-media-picker__controls">
                  <button class="admin-button admin-button--secondary" type="button" data-gallery-open>Dateien auswählen</button>
                  <button class="admin-button admin-button--secondary" type="button" data-upload-trigger-multi>Dateien hochladen</button>
                  <input type="file" name="article_<%= lang.key %>_gallery_uploads" accept="video/*,image/*" multiple data-upload-input-multi hidden>
                </div>
                <input type="hidden" name="article_<%= lang.key %>_gallery_items" data-gallery-multi-input>
                <div class="admin-media-picker__list" data-gallery-multi-list></div>
                <small data-gallery-preview>Keine Dateien ausgewählt.</small>
              </div>
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__actions">
          <button type="submit" class="admin-button">Speichern ✓</button>
        </div>
      </form>

      <% if (adminError === 'article-group' && articlesTab === 'edit') { %>
      <div class="admin-panel__alert admin-panel__alert--error">
        Bitte wähle zuerst einen Artikel aus.
      </div>
      <% } else if (adminError === 'article-required' && articlesTab === 'edit') { %>
      <div class="admin-panel__alert admin-panel__alert--error">
        Bitte fülle alle Pflichtfelder für: <%= adminMissing || 'die ausgewählten Sprachen' %>.
      </div>
      <% } else if (adminError === 'article-empty' && articlesTab === 'edit') { %>
      <div class="admin-panel__alert admin-panel__alert--error">
        Bitte fülle mindestens eine Sprache vollständig aus.
      </div>
      <% } else if (adminError === 'article-media' && articlesTab === 'edit') { %>
      <div class="admin-panel__alert admin-panel__alert--error">
        Bitte wähle ein Bild oder Video für den Einleitungsbereich.
      </div>
      <% } else if (adminSaved && adminQuery.nav === 'articles' && articlesTab === 'edit') { %>
      <div class="admin-panel__alert admin-panel__alert--success">
        Artikel erfolgreich gespeichert.
      </div>
      <% } %>

      <div class="admin-panel <%= articlesTab === 'edit' ? '' : 'is-hidden' %>" data-panel="edit" data-panel-group="articles">
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Artikel auswählen</h3>
          <form class="admin-article-select" method="get" action="/adminbackend" data-article-select-form>
            <input type="hidden" name="nav" value="articles">
            <input type="hidden" name="articlesTab" value="edit">
            <label class="admin-field">
              <span>Artikel (Deutsch):</span>
              <select name="newsGroupId" data-article-select>
                <option value="">Bitte auswählen</option>
                <% articleOptionList.forEach((option) => { %>
                <option value="<%= option.id %>" <%= isSelected(option.id, adminQuery.newsGroupId) %>><%= option.title %></option>
                <% }) %>
              </select>
            </label>
          </form>
          <% if (!articleOptionList.length) { %>
          <p>Es sind aktuell keine Artikel vorhanden.</p>
          <% } %>
        </div>
      </div>

      <% if (selectedGroup && articlesTab === 'edit') { %>
      <form class="admin-panel" method="post" action="/adminbackend/articles/<%= selectedGroup.id %>" enctype="multipart/form-data" data-panel="edit" data-panel-group="articles">
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Basisdaten</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Titel <%= lang.label %>:</label>
              <input type="text" name="article_<%= lang.key %>_title" value="<%= safeValue(articleValue(lang.key, 'title')) %>" placeholder="Titel eingeben...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Meta <%= lang.label %>:</label>
              <input type="text" name="article_<%= lang.key %>_meta" value="<%= safeValue(articleValue(lang.key, 'meta_description')) %>" placeholder="Meta-Description eingeben...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>H1 <%= lang.label %>:</label>
              <input type="text" name="article_<%= lang.key %>_h1" value="<%= safeValue(articleValue(lang.key, 'h1_title')) %>" placeholder="H1 Titel eingeben...">
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Artikel Einleitung Bereich</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Einleitungs-Titel <%= lang.label %>:</label>
              <input type="text" name="article_<%= lang.key %>_intro_title" value="<%= safeValue(articleValue(lang.key, 'h2_title')) %>" placeholder="Einleitungstitel eingeben...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Einleitung Beschreibung <%= lang.label %>:</label>
              <textarea name="article_<%= lang.key %>_intro_description" placeholder="Einleitungsbeschreibung eingeben..."><%= safeValue(articleValue(lang.key, 'description_short')) %></textarea>
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Bild oder Video <%= lang.label %>:</label>
              <div class="admin-media-picker" data-gallery-picker data-gallery-allow="image video" data-gallery-locale="<%= lang.key %>">
                <div class="admin-media-picker__controls">
                  <button class="admin-button admin-button--secondary" type="button" data-gallery-open>Datei auswählen</button>
                  <button class="admin-button admin-button--secondary" type="button" data-upload-trigger>Datei hochladen</button>
                  <input type="file" name="article_<%= lang.key %>_intro_media" accept="video/*,image/*" data-upload-input hidden>
                </div>
                <input type="hidden" name="article_<%= lang.key %>_intro_gallery_image_id" data-gallery-input="image">
                <input type="hidden" name="article_<%= lang.key %>_intro_gallery_video_id" data-gallery-input="video">
                <small data-gallery-preview>
                  <% if (articleValue(lang.key, 'title_image_url')) { %>
                  Aktuell:
                  <a class="admin-media-picker__preview-link" href="<%= articleValue(lang.key, 'title_image_url') %>" target="_blank" rel="noopener noreferrer" data-media-preview-url="<%= articleValue(lang.key, 'title_image_url') %>" title="<%= articleValue(lang.key, 'title_image_url') %>">
                    <%= truncateText(articleValue(lang.key, 'title_image_url')) %>
                  </a>
                  <% } else { %>
                  Keine Datei ausgewählt.
                  <% } %>
                </small>
              </div>
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Artikel Text</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Überschrift <%= lang.label %>:</label>
              <input type="text" name="article_<%= lang.key %>_body_title" value="<%= safeValue(articleValue(lang.key, 'body_title')) %>" placeholder="Überschrift eingeben...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Artikel Text <%= lang.label %>:</label>
              <textarea name="article_<%= lang.key %>_body_text" placeholder="Artikeltext eingeben..."><%= safeValue(articleValue(lang.key, 'description_long')) %></textarea>
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Bilder oder Videos hinzufügen (<%= lang.label %>, optional):</label>
              <div class="admin-media-picker" data-gallery-picker data-gallery-allow="image video" data-gallery-mode="multi" data-gallery-locale="<%= lang.key %>">
                <div class="admin-media-picker__controls">
                  <button class="admin-button admin-button--secondary" type="button" data-gallery-open>Dateien auswählen</button>
                  <button class="admin-button admin-button--secondary" type="button" data-upload-trigger-multi>Dateien hochladen</button>
                  <input type="file" name="article_<%= lang.key %>_gallery_uploads" accept="video/*,image/*" multiple data-upload-input-multi hidden>
                </div>
                <% const galleryItems = articleGalleryItems(lang.key).map((item) => ({ ...item, source: item.source || 'existing' })); %>
                <input type="hidden" name="article_<%= lang.key %>_gallery_items" data-gallery-multi-input value="<%= JSON.stringify(galleryItems) %>">
                <div class="admin-media-picker__list" data-gallery-multi-list></div>
                <small data-gallery-preview>
                  <%= galleryItems.length ? `${galleryItems.length} Datei(en) ausgewählt.` : 'Keine Dateien ausgewählt.' %>
                </small>
              </div>
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__actions">
          <button type="submit" class="admin-button">Speichern ✓</button>
        </div>
      </form>
      <% } else if (articlesTab === 'edit') { %>
      <div class="admin-panel" data-panel="edit" data-panel-group="articles">
        <div class="admin-panel__section">
          <p>Bitte wähle einen Artikel aus, um die Inhalte zu bearbeiten.</p>
        </div>
      </div>
      <% } %>

      <% if (adminError === 'article-action' && articlesTab === 'delete') { %>
      <div class="admin-panel__alert admin-panel__alert--error">
        Bitte wähle mindestens einen Artikel für die Aktion aus.
      </div>
      <% } else if (adminSaved && adminQuery.nav === 'articles' && articlesTab === 'delete') { %>
      <div class="admin-panel__alert admin-panel__alert--success">
        Aktion erfolgreich ausgeführt.
      </div>
      <% } %>

      <div class="admin-panel <%= articlesTab === 'delete' ? '' : 'is-hidden' %>" data-panel="delete" data-panel-group="articles">
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Artikel löschen</h3>
          <p>Wähle die News-Artikel aus, die angezeigt, ausgeblendet oder gelöscht werden sollen.</p>
        </div>
        <div class="admin-article-grid">
          <% articleGroups.forEach((group) => { %>
          <% const deArticle = group.articles?.de; %>
          <% if (!deArticle) return; %>
          <div class="admin-article-card" data-article-card data-article-group-id="<%= group.id %>" data-article-languages="<%= Object.keys(group.articles || {}).join(',') %>">
            <div class="admin-article-card__actions">
              <label class="admin-article-card__toggle">
                <input type="checkbox" <%= deArticle.display ? 'checked' : '' %> data-article-action="visibility" data-article-group-id="<%= group.id %>" data-article-visible="<%= deArticle.display ? 'true' : 'false' %>" data-article-languages="<%= Object.keys(group.articles || {}).join(',') %>">
                <span>Anzeigen</span>
              </label>
              <button type="button" class="admin-article-card__delete" data-article-action="delete" data-article-group-id="<%= group.id %>" data-article-languages="<%= Object.keys(group.articles || {}).join(',') %>">×</button>
            </div>
            <%- include('../components/newsCard', { article: deArticle }) %>
          </div>
          <% }) %>
        </div>
      </div>

      <div class="admin-article-modal is-hidden" data-article-modal>
        <div class="admin-article-modal__backdrop" data-article-modal-close></div>
        <div class="admin-article-modal__dialog">
          <header class="admin-article-modal__header">
            <h3 data-article-modal-title>Aktion bestätigen</h3>
            <button type="button" class="admin-article-modal__close" data-article-modal-close>×</button>
          </header>
          <p data-article-modal-text>Bitte wähle die gewünschten Artikel aus.</p>
          <form class="admin-article-modal__form" method="post" action="/adminbackend/articles/actions" data-article-modal-form>
            <input type="hidden" name="news_group_id" value="" data-article-modal-group>
            <input type="hidden" name="action" value="" data-article-modal-action>
            <input type="hidden" name="visibility" value="" data-article-modal-visibility>
            <label class="admin-field admin-field--checkbox">
              <input type="checkbox" data-article-modal-all>
              <span data-article-modal-all-label>Alle Artikel</span>
            </label>
            <div class="admin-article-modal__options">
              <label class="admin-field admin-field--checkbox">
                <input type="checkbox" name="languages" value="de" data-article-modal-lang="de">
                <span>Deutscher Artikel</span>
              </label>
              <label class="admin-field admin-field--checkbox">
                <input type="checkbox" name="languages" value="en" data-article-modal-lang="en">
                <span>Englischer Artikel</span>
              </label>
              <label class="admin-field admin-field--checkbox">
                <input type="checkbox" name="languages" value="ku" data-article-modal-lang="ku">
                <span>Kurdischer Artikel</span>
              </label>
            </div>
            <div class="admin-panel__actions admin-panel__actions--inline">
              <button type="button" class="admin-button admin-button--secondary" data-article-modal-close>Abbrechen</button>
              <button type="submit" class="admin-button">Bestätigen ✓</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <div class="admin-content__section is-hidden" data-nav-content="films">
      <header class="admin-content__header">
        <h2>Filmbearbeitung</h2>
        <p>Lege neue Filme an, bearbeite bestehende Einträge oder blende sie ein und aus.</p>
        <div class="admin-tabs" data-admin-tabs="films">
          <button class="admin-tab <%= filmsTab === 'create' ? 'is-active' : '' %>" type="button" data-tab="create">Film hinzufügen</button>
          <button class="admin-tab <%= filmsTab === 'edit' ? 'is-active' : '' %>" type="button" data-tab="edit">Film bearbeiten</button>
          <button class="admin-tab <%= filmsTab === 'delete' ? 'is-active' : '' %>" type="button" data-tab="delete">Film ein-/ausblenden</button>
        </div>
      </header>

      <% if (adminError === 'film-required' && filmsTab === 'create') { %>
      <div class="admin-panel__alert admin-panel__alert--error">
        <% if (adminMissingFields) { %>
        Bitte fülle folgende Pflichtfelder aus: <%= adminMissingFields %>.
        <% } else { %>
        Bitte fülle alle Pflichtfelder für: <%= adminMissing || 'die ausgewählten Sprachen' %>.
        <% } %>
      </div>
      <% } else if (adminError === 'film-empty' && filmsTab === 'create') { %>
      <div class="admin-panel__alert admin-panel__alert--error">
        Bitte fülle mindestens eine Sprache vollständig aus.
      </div>
      <% } else if (adminError === 'film-thumbnail' && filmsTab === 'create') { %>
      <div class="admin-panel__alert admin-panel__alert--error">
        Bitte wähle ein Thumbnail-Bild für den Film.
      </div>
      <% } else if (adminError === 'film-video' && filmsTab === 'create') { %>
      <div class="admin-panel__alert admin-panel__alert--error">
        Bitte hinterlege einen Video-Embed-Code oder eine Video-Datei für den Film.
      </div>
      <% } else if (adminSaved && adminQuery.nav === 'films' && filmsTab === 'create') { %>
      <div class="admin-panel__alert admin-panel__alert--success">
        Film erfolgreich gespeichert.
      </div>
      <% } %>

      <form class="admin-panel <%= filmsTab === 'create' ? '' : 'is-hidden' %>" method="post" action="/adminbackend/films" enctype="multipart/form-data" data-panel="create" data-panel-group="films">
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Neuen Film hinzufügen</h3>
          <p>Lege neue Filme für Deutsch, Englisch oder Kurdisch an.</p>
        </div>
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Basisdaten</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Titel <%= lang.label %>:</label>
              <input type="text" name="film_<%= lang.key %>_title" placeholder="Titel eingeben...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Kurzbeschreibung <%= lang.label %>:</label>
              <textarea name="film_<%= lang.key %>_description_short" placeholder="Kurzbeschreibung eingeben..."></textarea>
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Beschreibung <%= lang.label %>:</label>
              <textarea name="film_<%= lang.key %>_description" placeholder="Beschreibung eingeben..."></textarea>
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Kategorie <%= lang.label %>:</label>
              <select name="film_<%= lang.key %>_category">
                <option value="">Bitte auswählen</option>
                <% filmCategoryOptions.forEach((category) => { %>
                <option value="<%= category.value %>"><%= category.labels[lang.key] || category.value %></option>
                <% }) %>
              </select>
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Laufzeit <%= lang.label %> in min angeben:</label>
              <input type="text" name="film_<%= lang.key %>_duration" placeholder="z.B. 90 (ohne Minutenangabe)">
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Film Details</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Regie <%= lang.label %>:</label>
              <select name="film_<%= lang.key %>_regie_id">
                <option value="">Bitte auswählen</option>
                <% directorOptions(lang.key).forEach((director) => { %>
                <option value="<%= director.director_id %>"><%= director.name %></option>
                <% }) %>
              </select>
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Produktion <%= lang.label %>:</label>
              <input type="text" name="film_<%= lang.key %>_production" placeholder="Produktion eingeben...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Sprachen <%= lang.label %>:</label>
              <input type="text" name="film_<%= lang.key %>_languages" placeholder="Deutsch, Kurdisch">
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Medien</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Thumbnail <%= lang.label %>:</label>
              <div class="admin-media-picker" data-gallery-picker data-gallery-allow="image" data-gallery-locale="<%= lang.key %>">
                <div class="admin-media-picker__controls">
                  <button class="admin-button admin-button--secondary" type="button" data-gallery-open>Datei auswählen</button>
                  <button class="admin-button admin-button--secondary" type="button" data-upload-trigger>Datei hochladen</button>
                  <input type="file" name="film_<%= lang.key %>_thumbnail_media" accept="image/*" data-upload-input hidden>
                </div>
                <input type="hidden" name="film_<%= lang.key %>_thumbnail_gallery_image_id" data-gallery-input="image">
                <small data-gallery-preview>Keine Datei ausgewählt.</small>
              </div>
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Video Embed Code <%= lang.label %> (optional):</label>
              <textarea name="film_<%= lang.key %>_video_embed_code" placeholder="z.B. <iframe src=&quot;...&quot; ...></iframe>"></textarea>
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Video Datei <%= lang.label %> (optional):</label>
              <div class="admin-media-picker" data-gallery-picker data-gallery-allow="video" data-gallery-locale="<%= lang.key %>">
                <div class="admin-media-picker__controls">
                  <button class="admin-button admin-button--secondary" type="button" data-gallery-open>Datei auswählen</button>
                  <button class="admin-button admin-button--secondary" type="button" data-upload-trigger>Datei hochladen</button>
                  <input type="file" name="film_<%= lang.key %>_video_media" accept="video/*" data-upload-input hidden>
                </div>
                <input type="hidden" name="film_<%= lang.key %>_video_gallery_video_id" data-gallery-input="video">
                <small data-gallery-preview>Keine Datei ausgewählt.</small>
              </div>
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Weitere Bilder (<%= lang.label %>, optional):</label>
              <div class="admin-media-picker" data-gallery-picker data-gallery-allow="image" data-gallery-mode="multi" data-gallery-locale="<%= lang.key %>">
                <div class="admin-media-picker__controls">
                  <button class="admin-button admin-button--secondary" type="button" data-gallery-open>Dateien auswählen</button>
                  <button class="admin-button admin-button--secondary" type="button" data-upload-trigger-multi>Dateien hochladen</button>
                  <input type="file" name="film_<%= lang.key %>_other_images_uploads" accept="image/*" multiple data-upload-input-multi hidden>
                </div>
                <input type="hidden" name="film_<%= lang.key %>_other_images_items" data-gallery-multi-input>
                <div class="admin-media-picker__list" data-gallery-multi-list></div>
                <small data-gallery-preview>Keine Dateien ausgewählt.</small>
              </div>
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__actions">
          <button type="submit" class="admin-button">Speichern ✓</button>
        </div>
      </form>

      <% if (adminError === 'film-group' && filmsTab === 'edit') { %>
      <div class="admin-panel__alert admin-panel__alert--error">
        Bitte wähle zuerst einen Film aus.
      </div>
      <% } else if (adminError === 'film-required' && filmsTab === 'edit') { %>
      <div class="admin-panel__alert admin-panel__alert--error">
        <% if (adminMissingFields) { %>
        Bitte fülle folgende Pflichtfelder aus: <%= adminMissingFields %>.
        <% } else { %>
        Bitte fülle alle Pflichtfelder für: <%= adminMissing || 'die ausgewählten Sprachen' %>.
        <% } %>
      </div>
      <% } else if (adminError === 'film-empty' && filmsTab === 'edit') { %>
      <div class="admin-panel__alert admin-panel__alert--error">
        Bitte fülle mindestens eine Sprache vollständig aus.
      </div>
      <% } else if (adminError === 'film-thumbnail' && filmsTab === 'edit') { %>
      <div class="admin-panel__alert admin-panel__alert--error">
        Bitte wähle ein Thumbnail-Bild für den Film.
      </div>
      <% } else if (adminError === 'film-video' && filmsTab === 'edit') { %>
      <div class="admin-panel__alert admin-panel__alert--error">
        Bitte hinterlege einen Video-Embed-Code oder eine Video-Datei für den Film.
      </div>
      <% } else if (adminSaved && adminQuery.nav === 'films' && filmsTab === 'edit') { %>
      <div class="admin-panel__alert admin-panel__alert--success">
        Film erfolgreich gespeichert.
      </div>
      <% } %>

      <div class="admin-panel <%= filmsTab === 'edit' ? '' : 'is-hidden' %>" data-panel="edit" data-panel-group="films">
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Film auswählen</h3>
          <form class="admin-film-select" method="get" action="/adminbackend" data-film-select-form>
            <input type="hidden" name="nav" value="films">
            <input type="hidden" name="filmsTab" value="edit">
            <label class="admin-field">
              <span>Film (Deutsch):</span>
              <select name="mediaGroupId" data-film-select>
                <option value="">Bitte auswählen</option>
                <% mediaOptionList.forEach((option) => { %>
                <option value="<%= option.id %>" <%= isSelected(option.id, adminQuery.mediaGroupId) %>><%= option.title %></option>
                <% }) %>
              </select>
            </label>
          </form>
          <% if (!mediaOptionList.length) { %>
          <p>Es sind aktuell keine Filme vorhanden.</p>
          <% } %>
        </div>
      </div>

      <% if (selectedMedia && filmsTab === 'edit') { %>
      <form class="admin-panel" method="post" action="/adminbackend/films/<%= selectedMedia.id %>" enctype="multipart/form-data" data-panel="edit" data-panel-group="films">
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Basisdaten</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Titel <%= lang.label %>:</label>
              <input type="text" name="film_<%= lang.key %>_title" value="<%= safeValue(mediaValue(lang.key, 'title')) %>" placeholder="Titel eingeben...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Kurzbeschreibung <%= lang.label %>:</label>
              <textarea name="film_<%= lang.key %>_description_short" placeholder="Kurzbeschreibung eingeben..."><%= safeValue(mediaValue(lang.key, 'description_short')) %></textarea>
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Beschreibung <%= lang.label %>:</label>
              <textarea name="film_<%= lang.key %>_description" placeholder="Beschreibung eingeben..."><%= safeValue(mediaValue(lang.key, 'description')) %></textarea>
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Kategorie <%= lang.label %>:</label>
              <select name="film_<%= lang.key %>_category">
                <option value="">Bitte auswählen</option>
                <% filmCategoryOptions.forEach((category) => { %>
                <option value="<%= category.value %>" <%= isSelected(category.value, mediaValue(lang.key, 'category')) %>>
                  <%= category.labels[lang.key] || category.value %>
                </option>
                <% }) %>
              </select>
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Laufzeit <%= lang.label %> in min angeben:</label>
              <input type="text" name="film_<%= lang.key %>_duration" value="<%= safeValue(mediaValue(lang.key, 'duration')) %>" placeholder="z.B. 90 (ohne Minutenangabe)">
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Film Details</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Regie <%= lang.label %>:</label>
              <select name="film_<%= lang.key %>_regie_id">
                <option value="">Bitte auswählen</option>
                <% const selectedRegieId = mediaValue(lang.key, 'regie_id'); %>
                <% const hasSelectedRegie = directorOptions(lang.key).some((director) => String(director.director_id) === String(selectedRegieId)); %>
                <% if (selectedRegieId && !hasSelectedRegie) { %>
                <option value="<%= selectedRegieId %>" selected>
                  <%= mediaValue(lang.key, 'regie') || 'Aktuelle Regie' %>
                </option>
                <% } %>
                <% directorOptions(lang.key).forEach((director) => { %>
                <option value="<%= director.director_id %>" <%= isSelected(director.director_id, mediaValue(lang.key, 'regie_id')) %>>
                  <%= director.name %>
                </option>
                <% }) %>
              </select>
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Produktion <%= lang.label %>:</label>
              <input type="text" name="film_<%= lang.key %>_production" value="<%= safeValue(mediaValue(lang.key, 'production')) %>" placeholder="Produktion eingeben...">
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Sprachen <%= lang.label %>:</label>
              <input type="text" name="film_<%= lang.key %>_languages" value="<%= safeValue(mediaLanguagesValue(lang.key)) %>" placeholder="Deutsch, Kurdisch">
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Medien</h3>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Thumbnail <%= lang.label %>:</label>
              <div class="admin-media-picker" data-gallery-picker data-gallery-allow="image" data-gallery-locale="<%= lang.key %>">
                <div class="admin-media-picker__controls">
                  <button class="admin-button admin-button--secondary" type="button" data-gallery-open>Datei auswählen</button>
                  <button class="admin-button admin-button--secondary" type="button" data-upload-trigger>Datei hochladen</button>
                  <input type="file" name="film_<%= lang.key %>_thumbnail_media" accept="image/*" data-upload-input hidden>
                </div>
                <input type="hidden" name="film_<%= lang.key %>_thumbnail_gallery_image_id" data-gallery-input="image">
                <small data-gallery-preview>
                  <% if (mediaValue(lang.key, 'thumbnail_url')) { %>
                  Aktuell:
                  <a class="admin-media-picker__preview-link" href="<%= mediaValue(lang.key, 'thumbnail_url') %>" target="_blank" rel="noopener noreferrer" data-media-preview-url="<%= mediaValue(lang.key, 'thumbnail_url') %>" title="<%= mediaValue(lang.key, 'thumbnail_url') %>">
                    <%= truncateText(mediaValue(lang.key, 'thumbnail_url')) %>
                  </a>
                  <% } else { %>
                  Keine Datei ausgewählt.
                  <% } %>
                </small>
              </div>
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Video Embed Code <%= lang.label %> (optional):</label>
              <textarea name="film_<%= lang.key %>_video_embed_code" placeholder="z.B. <iframe src=&quot;...&quot; ...></iframe>"><%= safeValue(mediaValue(lang.key, 'video_url')) %></textarea>
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Video Datei <%= lang.label %> (optional):</label>
              <div class="admin-media-picker" data-gallery-picker data-gallery-allow="video" data-gallery-locale="<%= lang.key %>">
                <div class="admin-media-picker__controls">
                  <button class="admin-button admin-button--secondary" type="button" data-gallery-open>Datei auswählen</button>
                  <button class="admin-button admin-button--secondary" type="button" data-upload-trigger>Datei hochladen</button>
                  <input type="file" name="film_<%= lang.key %>_video_media" accept="video/*" data-upload-input hidden>
                </div>
                <input type="hidden" name="film_<%= lang.key %>_video_gallery_video_id" data-gallery-input="video">
                <small data-gallery-preview>
                  <% if (mediaValue(lang.key, 'video_url')) { %>
                  Aktueller Embed Code: <%= mediaValue(lang.key, 'video_url') %>
                  <% } else { %>
                  Keine Datei ausgewählt.
                  <% } %>
                </small>
              </div>
            </div>
            <% }) %>
          </div>
          <div class="admin-grid">
            <% langs.forEach((lang) => { %>
            <div class="admin-field">
              <label>Weitere Bilder (<%= lang.label %>, optional):</label>
              <div class="admin-media-picker" data-gallery-picker data-gallery-allow="image" data-gallery-mode="multi" data-gallery-locale="<%= lang.key %>">
                <div class="admin-media-picker__controls">
                  <button class="admin-button admin-button--secondary" type="button" data-gallery-open>Dateien auswählen</button>
                  <button class="admin-button admin-button--secondary" type="button" data-upload-trigger-multi>Dateien hochladen</button>
                  <input type="file" name="film_<%= lang.key %>_other_images_uploads" accept="image/*" multiple data-upload-input-multi hidden>
                </div>
                <% const mediaImages = mediaOtherImages(lang.key).map((item) => ({ url: item, source: 'existing' })); %>
                <input type="hidden" name="film_<%= lang.key %>_other_images_items" data-gallery-multi-input value="<%= JSON.stringify(mediaImages) %>">
                <div class="admin-media-picker__list" data-gallery-multi-list></div>
                <small data-gallery-preview>
                  <%= mediaImages.length ? `${mediaImages.length} Datei(en) ausgewählt.` : 'Keine Dateien ausgewählt.' %>
                </small>
              </div>
            </div>
            <% }) %>
          </div>
        </div>

        <div class="admin-panel__actions">
          <button type="submit" class="admin-button">Speichern ✓</button>
        </div>
      </form>
      <% } else if (filmsTab === 'edit') { %>
      <div class="admin-panel" data-panel="edit" data-panel-group="films">
        <div class="admin-panel__section">
          <p>Bitte wähle einen Film aus, um die Inhalte zu bearbeiten.</p>
        </div>
      </div>
      <% } %>

      <% if (adminError === 'film-action' && filmsTab === 'delete') { %>
      <div class="admin-panel__alert admin-panel__alert--error">
        Bitte wähle mindestens einen Film für die Aktion aus.
      </div>
      <% } else if (adminSaved && adminQuery.nav === 'films' && filmsTab === 'delete') { %>
      <div class="admin-panel__alert admin-panel__alert--success">
        Aktion erfolgreich ausgeführt.
      </div>
      <% } %>

      <div class="admin-panel <%= filmsTab === 'delete' ? '' : 'is-hidden' %>" data-panel="delete" data-panel-group="films">
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Film ein-/ausblenden</h3>
          <p>Wähle die Filme aus, die angezeigt, ausgeblendet oder gelöscht werden sollen.</p>
        </div>
        <div class="admin-film-grid">
          <% mediaGroups.forEach((group) => { %>
          <% const deVideo = group.videos?.de; %>
          <% if (!deVideo) return; %>
          <div class="admin-film-card" data-film-card data-film-group-id="<%= group.id %>" data-film-languages="<%= Object.keys(group.videos || {}).join(',') %>">
            <div class="admin-film-card__actions">
              <label class="admin-film-card__toggle">
                <input type="checkbox" <%= deVideo.display ? 'checked' : '' %> data-film-action="visibility" data-film-group-id="<%= group.id %>" data-film-languages="<%= Object.keys(group.videos || {}).join(',') %>">
                <span>Anzeigen</span>
              </label>
              <button type="button" class="admin-film-card__delete" data-film-action="delete" data-film-group-id="<%= group.id %>" data-film-languages="<%= Object.keys(group.videos || {}).join(',') %>">×</button>
            </div>
            <div class="admin-film-card__body">
              <div class="admin-film-card__thumb" style="<%= deVideo.thumbnail_url ? `background-image: url('${deVideo.thumbnail_url}')` : '' %>"></div>
              <div class="admin-film-card__title"><%= deVideo.title %></div>
            </div>
          </div>
          <% }) %>
        </div>
      </div>

      <div class="admin-film-modal is-hidden" data-film-modal>
        <div class="admin-film-modal__backdrop" data-film-modal-close></div>
        <div class="admin-film-modal__dialog">
          <header class="admin-film-modal__header">
            <h3 data-film-modal-title>Aktion bestätigen</h3>
            <button type="button" class="admin-film-modal__close" data-film-modal-close>×</button>
          </header>
          <p data-film-modal-text>Bitte wähle die gewünschten Filme aus.</p>
          <form class="admin-film-modal__form" method="post" action="/adminbackend/films/actions" data-film-modal-form>
            <input type="hidden" name="media_group_id" value="" data-film-modal-group>
            <input type="hidden" name="action" value="" data-film-modal-action>
            <input type="hidden" name="visibility" value="" data-film-modal-visibility>
            <label class="admin-field admin-field--checkbox">
              <input type="checkbox" data-film-modal-all>
              <span data-film-modal-all-label>Alle Filme</span>
            </label>
            <div class="admin-film-modal__options">
              <label class="admin-field admin-field--checkbox">
                <input type="checkbox" name="languages" value="de" data-film-modal-lang="de">
                <span>Deutscher Film</span>
              </label>
              <label class="admin-field admin-field--checkbox">
                <input type="checkbox" name="languages" value="en" data-film-modal-lang="en">
                <span>Englischer Film</span>
              </label>
              <label class="admin-field admin-field--checkbox">
                <input type="checkbox" name="languages" value="ku" data-film-modal-lang="ku">
                <span>Kurdischer Film</span>
              </label>
            </div>
            <div class="admin-panel__actions admin-panel__actions--inline">
              <button type="button" class="admin-button admin-button--secondary" data-film-modal-close>Abbrechen</button>
              <button type="submit" class="admin-button">Bestätigen ✓</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <div class="admin-content__section is-hidden" data-nav-content="directors">
      <header class="admin-content__header">
        <h2>Regie verwalten</h2>
        <p>Lege neue Regie-Seiten an, bearbeite bestehende Einträge oder lösche sie.</p>
        <div class="admin-tabs" data-admin-tabs="directors">
          <button class="admin-tab <%= directorsTab === 'create' ? 'is-active' : '' %>" type="button" data-tab="create">Regie hinzufügen</button>
          <button class="admin-tab <%= directorsTab === 'edit' ? 'is-active' : '' %>" type="button" data-tab="edit">Regie bearbeiten</button>
          <button class="admin-tab <%= directorsTab === 'delete' ? 'is-active' : '' %>" type="button" data-tab="delete">Regie löschen</button>
        </div>
      </header>

      <% if (adminError === 'director-required' && directorsTab === 'create') { %>
      <div class="admin-panel__alert admin-panel__alert--error">
        <% if (adminMissingFields) { %>
        Bitte fülle folgende Pflichtfelder aus: <%= adminMissingFields %>.
        <% } else { %>
        Bitte fülle alle Pflichtfelder für: <%= adminMissing || 'die ausgewählten Sprachen' %>.
        <% } %>
      </div>
      <% } else if (adminError === 'director-empty' && directorsTab === 'create') { %>
      <div class="admin-panel__alert admin-panel__alert--error">
        Bitte fülle mindestens eine Sprache vollständig aus.
      </div>
      <% } else if (adminSaved && adminQuery.nav === 'directors' && directorsTab === 'create') { %>
      <div class="admin-panel__alert admin-panel__alert--success">
        Regie erfolgreich gespeichert.
      </div>
      <% } %>

      <form class="admin-panel <%= directorsTab === 'create' ? '' : 'is-hidden' %>" method="post" action="/adminbackend/directors" enctype="multipart/form-data" data-panel="create" data-panel-group="directors">
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Neue Regie anlegen</h3>
          <p>Der Seitentitel wird automatisch als „Regie - Name der Regie“ gesetzt.</p>
        </div>
        <% langs.forEach((lang) => { %>
        <div class="admin-panel__section">
          <h3 class="admin-panel__title"><%= lang.label %></h3>
          <div class="admin-grid">
            <div class="admin-field">
              <label>Name <%= lang.label %>:</label>
              <input type="text" name="director_<%= lang.key %>_name" placeholder="Name eingeben..." data-director-name data-director-locale="<%= lang.key %>">
            </div>
            <div class="admin-field">
              <label>Titel (auto):</label>
              <input type="text" name="director_<%= lang.key %>_title" placeholder="Regie - ..." readonly data-director-title data-director-locale="<%= lang.key %>">
            </div>
          </div>
          <div class="admin-grid">
            <div class="admin-field">
              <label>Meta Description <%= lang.label %>:</label>
              <input type="text" name="director_<%= lang.key %>_meta" placeholder="Meta Description eingeben...">
            </div>
          </div>
          <div class="admin-grid">
            <div class="admin-field">
              <label>Beschreibung <%= lang.label %>:</label>
              <textarea name="director_<%= lang.key %>_description" placeholder="Text zur Regie eingeben..."></textarea>
            </div>
          </div>
          <div class="admin-grid">
            <div class="admin-field">
              <label>Hintergrundbild <%= lang.label %>:</label>
              <div class="admin-media-picker" data-gallery-picker data-gallery-allow="image" data-gallery-locale="<%= lang.key %>">
                <div class="admin-media-picker__controls">
                  <button class="admin-button admin-button--secondary" type="button" data-gallery-open>Datei auswählen</button>
                  <button class="admin-button admin-button--secondary" type="button" data-upload-trigger>Datei hochladen</button>
                  <input type="file" name="director_<%= lang.key %>_background_media" accept="image/*" data-upload-input hidden>
                </div>
                <input type="hidden" name="director_<%= lang.key %>_background_gallery_image_id" data-gallery-input="image">
                <small data-gallery-preview>Keine Datei ausgewählt.</small>
              </div>
            </div>
            <div class="admin-field">
              <label>Portrait <%= lang.label %>:</label>
              <div class="admin-media-picker" data-gallery-picker data-gallery-allow="image" data-gallery-locale="<%= lang.key %>">
                <div class="admin-media-picker__controls">
                  <button class="admin-button admin-button--secondary" type="button" data-gallery-open>Datei auswählen</button>
                  <button class="admin-button admin-button--secondary" type="button" data-upload-trigger>Datei hochladen</button>
                  <input type="file" name="director_<%= lang.key %>_portrait_media" accept="image/*" data-upload-input hidden>
                </div>
                <input type="hidden" name="director_<%= lang.key %>_portrait_gallery_image_id" data-gallery-input="image">
                <small data-gallery-preview>Keine Datei ausgewählt.</small>
              </div>
            </div>
          </div>
        </div>
        <% }) %>
        <div class="admin-panel__actions">
          <button type="submit" class="admin-button">Speichern ✓</button>
        </div>
      </form>

      <% if (adminError === 'director-id' && directorsTab === 'edit') { %>
      <div class="admin-panel__alert admin-panel__alert--error">
        Bitte wähle zuerst eine Regie aus.
      </div>
      <% } else if (adminError === 'director-required' && directorsTab === 'edit') { %>
      <div class="admin-panel__alert admin-panel__alert--error">
        <% if (adminMissingFields) { %>
        Bitte fülle folgende Pflichtfelder aus: <%= adminMissingFields %>.
        <% } else { %>
        Bitte fülle alle Pflichtfelder für: <%= adminMissing || 'die ausgewählten Sprachen' %>.
        <% } %>
      </div>
      <% } else if (adminError === 'director-empty' && directorsTab === 'edit') { %>
      <div class="admin-panel__alert admin-panel__alert--error">
        Bitte fülle mindestens eine Sprache vollständig aus.
      </div>
      <% } else if (adminSaved && adminQuery.nav === 'directors' && directorsTab === 'edit') { %>
      <div class="admin-panel__alert admin-panel__alert--success">
        Regie erfolgreich gespeichert.
      </div>
      <% } %>

      <div class="admin-panel <%= directorsTab === 'edit' ? '' : 'is-hidden' %>" data-panel="edit" data-panel-group="directors">
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Regie auswählen</h3>
          <form class="admin-film-select" method="get" action="/adminbackend">
            <input type="hidden" name="nav" value="directors">
            <input type="hidden" name="directorsTab" value="edit">
            <label class="admin-field">
              <span>Regie:</span>
              <select name="directorId">
                <option value="">Bitte auswählen</option>
                <% directorOptionList.forEach((option) => { %>
                <option value="<%= option.id %>" <%= isSelected(option.id, adminQuery.directorId) %>><%= option.title %></option>
                <% }) %>
              </select>
            </label>
            <button type="submit" class="admin-button admin-button--secondary">Laden</button>
          </form>
          <% if (!directorOptionList.length) { %>
          <p>Es sind aktuell keine Regie-Einträge vorhanden.</p>
          <% } %>
        </div>
      </div>

      <% if (selectedDirector && directorsTab === 'edit') { %>
      <form class="admin-panel" method="post" action="/adminbackend/directors/<%= selectedDirectorId %>" enctype="multipart/form-data" data-panel="edit" data-panel-group="directors">
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Regie bearbeiten</h3>
          <p>Der Seitentitel wird automatisch als „Regie - Name der Regie“ gesetzt.</p>
        </div>
        <% langs.forEach((lang) => { %>
        <div class="admin-panel__section">
          <h3 class="admin-panel__title"><%= lang.label %></h3>
          <div class="admin-grid">
            <div class="admin-field">
              <label>Name <%= lang.label %>:</label>
              <input type="text" name="director_<%= lang.key %>_name" value="<%= safeValue(directorValue(lang.key, 'name')) %>" data-director-name data-director-locale="<%= lang.key %>">
            </div>
            <div class="admin-field">
              <label>Titel (auto):</label>
              <input type="text" name="director_<%= lang.key %>_title" value="<%= directorValue(lang.key, 'name') ? `Regie - ${directorValue(lang.key, 'name')}` : '' %>" readonly data-director-title data-director-locale="<%= lang.key %>">
            </div>
          </div>
          <div class="admin-grid">
            <div class="admin-field">
              <label>Meta Description <%= lang.label %>:</label>
              <input type="text" name="director_<%= lang.key %>_meta" value="<%= safeValue(directorValue(lang.key, 'meta_description')) %>">
            </div>
          </div>
          <div class="admin-grid">
            <div class="admin-field">
              <label>Beschreibung <%= lang.label %>:</label>
              <textarea name="director_<%= lang.key %>_description"><%= safeValue(directorValue(lang.key, 'description')) %></textarea>
            </div>
          </div>
          <div class="admin-grid">
            <div class="admin-field">
              <label>Hintergrundbild <%= lang.label %>:</label>
              <div class="admin-media-picker" data-gallery-picker data-gallery-allow="image" data-gallery-locale="<%= lang.key %>">
                <div class="admin-media-picker__controls">
                  <button class="admin-button admin-button--secondary" type="button" data-gallery-open>Datei auswählen</button>
                  <button class="admin-button admin-button--secondary" type="button" data-upload-trigger>Datei hochladen</button>
                  <input type="file" name="director_<%= lang.key %>_background_media" accept="image/*" data-upload-input hidden>
                </div>
                <input type="hidden" name="director_<%= lang.key %>_background_gallery_image_id" data-gallery-input="image">
                <small data-gallery-preview>
                  <% if (directorValue(lang.key, 'background_image_url')) { %>
                  Aktuell:
                  <a class="admin-media-picker__preview-link" href="<%= directorValue(lang.key, 'background_image_url') %>" target="_blank" rel="noopener noreferrer" data-media-preview-url="<%= directorValue(lang.key, 'background_image_url') %>" title="<%= directorValue(lang.key, 'background_image_url') %>">
                    <%= truncateText(directorValue(lang.key, 'background_image_url')) %>
                  </a>
                  <% } else { %>
                  Keine Datei ausgewählt.
                  <% } %>
                </small>
              </div>
            </div>
            <div class="admin-field">
              <label>Portrait <%= lang.label %>:</label>
              <div class="admin-media-picker" data-gallery-picker data-gallery-allow="image" data-gallery-locale="<%= lang.key %>">
                <div class="admin-media-picker__controls">
                  <button class="admin-button admin-button--secondary" type="button" data-gallery-open>Datei auswählen</button>
                  <button class="admin-button admin-button--secondary" type="button" data-upload-trigger>Datei hochladen</button>
                  <input type="file" name="director_<%= lang.key %>_portrait_media" accept="image/*" data-upload-input hidden>
                </div>
                <input type="hidden" name="director_<%= lang.key %>_portrait_gallery_image_id" data-gallery-input="image">
                <small data-gallery-preview>
                  <% if (directorValue(lang.key, 'portrait_image_url')) { %>
                  Aktuell:
                  <a class="admin-media-picker__preview-link" href="<%= directorValue(lang.key, 'portrait_image_url') %>" target="_blank" rel="noopener noreferrer" data-media-preview-url="<%= directorValue(lang.key, 'portrait_image_url') %>" title="<%= directorValue(lang.key, 'portrait_image_url') %>">
                    <%= truncateText(directorValue(lang.key, 'portrait_image_url')) %>
                  </a>
                  <% } else { %>
                  Keine Datei ausgewählt.
                  <% } %>
                </small>
              </div>
            </div>
          </div>
        </div>
        <% }) %>
        <div class="admin-panel__actions">
          <button type="submit" class="admin-button">Änderungen speichern ✓</button>
        </div>
      </form>
      <% } else if (directorsTab === 'edit') { %>
      <div class="admin-panel" data-panel="edit" data-panel-group="directors">
        <div class="admin-panel__section">
          <p>Bitte wähle eine Regie aus, um die Inhalte zu bearbeiten.</p>
        </div>
      </div>
      <% } %>

      <% if (adminError === 'director-id' && directorsTab === 'delete') { %>
      <div class="admin-panel__alert admin-panel__alert--error">
        Bitte wähle zuerst eine Regie aus.
      </div>
      <% } else if (adminSaved && adminQuery.nav === 'directors' && directorsTab === 'delete') { %>
      <div class="admin-panel__alert admin-panel__alert--success">
        Regie erfolgreich gelöscht.
      </div>
      <% } %>

      <div class="admin-panel <%= directorsTab === 'delete' ? '' : 'is-hidden' %>" data-panel="delete" data-panel-group="directors">
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Regie löschen</h3>
          <p>Wähle die Regie aus, die gelöscht werden soll.</p>
          <form method="post" action="/adminbackend/directors/0/delete" data-director-delete-form>
            <label class="admin-field">
              <span>Regie:</span>
              <select name="directorId" data-director-delete-select>
                <option value="">Bitte auswählen</option>
                <% directorOptionList.forEach((option) => { %>
                <option value="<%= option.id %>" <%= isSelected(option.id, adminQuery.directorId) %>><%= option.title %></option>
                <% }) %>
              </select>
            </label>
            <button type="submit" class="admin-button admin-button--danger">Löschen</button>
          </form>
        </div>
      </div>
    </div>

    <div class="admin-content__section is-hidden" data-nav-content="tickets">
      <header class="admin-content__header">
        <h2>Tickets und Spenden verwalten</h2>
        <p>Hier kannst du Tickets erstellen, bearbeiten und Spenden einsehen.</p>
        <div class="admin-tabs" data-admin-tabs="tickets">
          <button class="admin-tab <%= ticketsTab === 'create' ? 'is-active' : '' %>" type="button" data-tab="create">Neues Ticket</button>
          <button class="admin-tab <%= ticketsTab === 'edit' ? 'is-active' : '' %>" type="button" data-tab="edit">Tickets bearbeiten</button>
          <button class="admin-tab <%= ticketsTab === 'standard-kino' ? 'is-active' : '' %>" type="button" data-tab="standard-kino">Standard-Kinoticket</button>
          <button class="admin-tab <%= ticketsTab === 'delete' ? 'is-active' : '' %>" type="button" data-tab="delete">Tickets anzeigen/löschen</button>
          <button class="admin-tab <%= ticketsTab === 'onlineaccess' ? 'is-active' : '' %>" type="button" data-tab="onlineaccess">Onlinezugang</button>
          <button class="admin-tab <%= ticketsTab === 'orders' ? 'is-active' : '' %>" type="button" data-tab="orders">Ticketkäufe</button>
          <button class="admin-tab <%= ticketsTab === 'donations' ? 'is-active' : '' %>" type="button" data-tab="donations">Spenden</button>
        </div>
      </header>

      <% if (adminError === 'ticket-group' && ticketsTab === 'edit') { %>
      <div class="admin-panel__alert admin-panel__alert--error">
        Bitte wähle zuerst ein Ticket aus.
      </div>
      <% } else if (adminError === 'ticket-required' && ticketsTab === 'create') { %>
      <div class="admin-panel__alert admin-panel__alert--error">
        <% if (adminMissingFields.some((field) => field.startsWith('ticket_event_price') || field.startsWith('ticket_preorder') || field.startsWith('ticket_early'))) { %>
        Preis muss noch eingetragen werden.
        <% } else { %>
        Bitte fülle alle Pflichtfelder für: <%= adminMissing || 'die ausgewählten Sprachen' %>.
        <% } %>
      </div>
      <% } else if (adminError === 'ticket-empty' && ticketsTab === 'create') { %>
      <div class="admin-panel__alert admin-panel__alert--error">
        Bitte fülle mindestens eine Sprache vollständig aus.
      </div>
      <% } else if (adminSaved && adminQuery.nav === 'tickets' && ticketsTab === 'create') { %>
      <div class="admin-panel__alert admin-panel__alert--success">
        Ticket erfolgreich gespeichert.
      </div>
      <% } %>

      <% if (adminError === 'standard-kino' && ticketsTab === 'standard-kino') { %>
      <div class="admin-panel__alert admin-panel__alert--error">
        Bitte fülle alle Pflichtfelder für das Standard-Kinoticket aus.
      </div>
      <% } else if (adminSaved && adminQuery.nav === 'tickets' && ticketsTab === 'standard-kino') { %>
      <div class="admin-panel__alert admin-panel__alert--success">
        Standard-Kinoticket erfolgreich gespeichert.
      </div>
      <% } %>

      <form class="admin-panel <%= ticketsTab === 'standard-kino' ? '' : 'is-hidden' %>" method="post" action="/adminbackend/standard-kino-ticket" data-panel="standard-kino" data-panel-group="tickets">
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Standard-Kinoticket konfigurieren</h3>
          <p>Lege den Standardpreis für zusätzliche Kinotickets fest und optional zeitlich begrenzte Rabatte.</p>
        </div>
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Preis &amp; Rabatte</h3>
          <div class="admin-grid">
            <div class="admin-field <%= fieldHasError('standard_kino_price') ? 'admin-field--error' : '' %>">
              <label>Regulärer Standardpreis (€):</label>
              <input type="text" name="standard_kino_price" value="<%= safeValue(standardKinoPrice) %>" placeholder="z.B. 12,00" required>
            </div>
            <div class="admin-field <%= fieldHasError('standard_kino_preorder_percent') ? 'admin-field--error' : '' %>">
              <label>Pre-Order Rabatt (%):</label>
              <input type="number" name="standard_kino_preorder_percent" min="0" max="100" value="<%= safeValue(calculateStandardDiscountPercent(standardKinoPhaseMap.preorder)) %>" required>
            </div>
            <div class="admin-field <%= fieldHasError('standard_kino_preorder_end') ? 'admin-field--error' : '' %>">
              <label>Pre-Order gültig bis:</label>
              <input type="date" name="standard_kino_preorder_end" value="<%= safeValue(formatDateValue(standardKinoPhaseMap.preorder?.end_at)) %>" required>
            </div>
          </div>
          <div class="admin-grid">
            <div class="admin-field <%= fieldHasError('standard_kino_early_percent') ? 'admin-field--error' : '' %>">
              <label>Frühbucher Rabatt (%):</label>
              <input type="number" name="standard_kino_early_percent" min="0" max="100" value="<%= safeValue(calculateStandardDiscountPercent(standardKinoPhaseMap.early)) %>">
            </div>
            <div class="admin-field <%= fieldHasError('standard_kino_early_end') ? 'admin-field--error' : '' %>">
              <label>Frühbucher gültig bis:</label>
              <input type="date" name="standard_kino_early_end" value="<%= safeValue(formatDateValue(standardKinoPhaseMap.early?.end_at)) %>">
            </div>
          </div>
          <small>Der Frühbucher-Rabatt ist optional. Alle anderen Felder sind Pflicht.</small>
        </div>
        <div class="admin-panel__actions">
          <button type="submit" class="admin-button">Speichern</button>
        </div>
      </form>

      <form class="admin-panel <%= ticketsTab === 'create' ? '' : 'is-hidden' %>" method="post" action="/adminbackend/media-tickets" data-panel="create" data-panel-group="tickets">
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Ticket-Typ</h3>
          <div class="admin-grid">
            <div class="admin-field <%= fieldHasError('ticket_type') ? 'admin-field--error' : '' %>">
              <label>Ticket Typ:</label>
              <select name="ticket_type" required>
                <option value="">Bitte auswählen</option>
                <option value="online">Onlineticket erstellen</option>
                <option value="kino">Kinoticket erstellen</option>
                <option value="combo">Kombiticket erstellen</option>
              </select>
            </div>
          </div>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Preis &amp; Rabatte</h3>
          <div class="admin-grid">
            <div class="admin-field <%= fieldHasError('ticket_event_price') ? 'admin-field--error' : '' %>">
              <label>Regulärer Preis (€):</label>
              <input type="text" name="ticket_event_price" placeholder="z.B. 49,00" required>
            </div>
            <div class="admin-field <%= fieldHasError('ticket_preorder_percent') ? 'admin-field--error' : '' %>">
              <label>Pre-Order Rabatt (%):</label>
              <input type="number" name="ticket_preorder_percent" min="0" max="100" placeholder="z.B. 20" required>
            </div>
            <div class="admin-field <%= fieldHasError('ticket_preorder_end') ? 'admin-field--error' : '' %>">
              <label>Pre-Order gültig bis:</label>
              <input type="date" name="ticket_preorder_end" required>
            </div>
          </div>
          <div class="admin-grid">
            <div class="admin-field <%= fieldHasError('ticket_early_percent') ? 'admin-field--error' : '' %>">
              <label>Frühbucher Rabatt (%):</label>
              <input type="number" name="ticket_early_percent" min="0" max="100" placeholder="optional">
            </div>
            <div class="admin-field <%= fieldHasError('ticket_early_end') ? 'admin-field--error' : '' %>">
              <label>Frühbucher gültig bis:</label>
              <input type="date" name="ticket_early_end" placeholder="optional">
            </div>
          </div>
          <small>Der Frühbucher-Rabatt ist optional. Alle anderen Felder sind Pflicht.</small>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Ticket Inhalte (alle Sprachen)</h3>
          <% langs.forEach((lang) => { %>
          <div class="admin-panel__section">
            <h4><%= lang.label %></h4>
            <div class="admin-grid">
              <div class="admin-field <%= fieldHasError(`ticket_${lang.key}_title`) ? 'admin-field--error' : '' %>">
                <label>Titel:</label>
                <input type="text" name="ticket_<%= lang.key %>_title" placeholder="Titel eingeben...">
              </div>
              <div class="admin-field <%= fieldHasError(`ticket_${lang.key}_text`) ? 'admin-field--error' : '' %>">
                <label>Beschreibung:</label>
                <input type="text" name="ticket_<%= lang.key %>_text" placeholder="Beschreibung eingeben...">
              </div>
            </div>
            <div class="admin-grid">
              <div class="admin-field <%= fieldHasError(`ticket_${lang.key}_badge_text`) ? 'admin-field--error' : '' %>">
                <label>Badge Text:</label>
                <input type="text" name="ticket_<%= lang.key %>_badge_text" placeholder="z.B. Neu">
              </div>
              <div class="admin-field <%= fieldHasError(`ticket_${lang.key}_badge_bg_color`) ? 'admin-field--error' : '' %>">
                <label>Badge Hintergrundfarbe auswählen:</label>
                <div class="admin-badge-picker" role="radiogroup" aria-label="Badge Hintergrundfarbe">
                  <% badgeColors.forEach((color, index) => { %>
                  <label class="admin-badge-option">
                    <input type="radio" name="ticket_<%= lang.key %>_badge_bg_color" value="<%= color.value %>" data-badge-color-input>
                    <span class="admin-badge-option__preview" style="--badge-color: <%= color.value %>;">
                      <span class="admin-badge-option__letter">A</span>
                    </span>
                    <span class="admin-badge-option__label"><%= color.label %></span>
                  </label>
                  <% }) %>
                </div>
                <input type="hidden" name="ticket_<%= lang.key %>_badge_text_color" data-badge-text-color value="">
              </div>
            </div>
            <div class="admin-grid">
              <div class="admin-field <%= fieldHasError(`ticket_${lang.key}_hint_text`) ? 'admin-field--error' : '' %>">
                <label>Hinweistext:</label>
                <input type="text" name="ticket_<%= lang.key %>_hint_text" placeholder="Hinweis eingeben...">
              </div>
              <div class="admin-field <%= fieldHasError(`ticket_${lang.key}_button_label`) ? 'admin-field--error' : '' %>">
                <label>Button Text:</label>
                <input type="text" name="ticket_<%= lang.key %>_button_label" placeholder="Ticket wählen">
              </div>
              <div class="admin-field <%= fieldHasError(`ticket_${lang.key}_button_url`) ? 'admin-field--error' : '' %>">
                <label>Button Link:</label>
                <input type="text" name="ticket_<%= lang.key %>_button_url" placeholder="/tickets">
              </div>
            </div>
            <div class="admin-grid">
              <% for (let index = 1; index <= 5; index += 1) { %>
              <div class="admin-field">
                <label>Feature <%= index %>:</label>
                <input type="text" name="ticket_<%= lang.key %>_feature_<%= index %>" placeholder="Feature Text...">
              </div>
              <% } %>
            </div>
          </div>
          <% }) %>
        </div>

        <div class="admin-panel__actions">
          <button type="submit" class="admin-button">Speichern ✓</button>
        </div>
      </form>

      <% if (adminError === 'ticket-required' && ticketsTab === 'edit') { %>
      <div class="admin-panel__alert admin-panel__alert--error">
        Bitte fülle alle Pflichtfelder für: <%= adminMissing || 'die ausgewählten Sprachen' %>.
      </div>
      <% } else if (adminError === 'ticket-empty' && ticketsTab === 'edit') { %>
      <div class="admin-panel__alert admin-panel__alert--error">
        Bitte fülle mindestens eine Sprache vollständig aus.
      </div>
      <% } else if (adminSaved && adminQuery.nav === 'tickets' && ticketsTab === 'edit') { %>
      <div class="admin-panel__alert admin-panel__alert--success">
        Ticket erfolgreich gespeichert.
      </div>
      <% } %>

      <div class="admin-panel <%= ticketsTab === 'edit' ? '' : 'is-hidden' %>" data-panel="edit" data-panel-group="tickets">
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Ticket auswählen</h3>
          <label class="admin-field">
            <span>Filter:</span>
            <select data-ticket-filter>
              <option value="all">Alle Tickets</option>
              <option value="kino">Kino Tickets</option>
              <option value="online">Online Tickets</option>
              <option value="combo">Kombi Ticket</option>
            </select>
          </label>
          <div class="admin-ticket-grid">
            <% ticketGroups.forEach((group) => { %>
            <% const displayTicket = group.tickets?.de || group.tickets?.en || group.tickets?.ku; %>
            <% if (!displayTicket) return; %>
            <a class="admin-ticket-card" href="/adminbackend?nav=tickets&ticketsTab=edit&ticketGroupId=<%= group.id %>" data-ticket-type="<%= displayTicket.ticket_type %>">
              <div class="admin-ticket-card__title"><%= displayTicket.title %></div>
              <div class="admin-ticket-card__meta"><%= displayTicket.ticket_type %></div>
              <div class="admin-ticket-card__description"><%= displayTicket.ticket_text || '' %></div>
              <div class="admin-ticket-card__price"><%= displayTicket.event_price ? `${displayTicket.event_price} €` : '' %></div>
            </a>
            <% }) %>
          </div>
        </div>
      </div>

      <% if (selectedTicket && ticketsTab === 'edit') { %>
      <form class="admin-panel" method="post" action="/adminbackend/media-tickets/<%= selectedTicket.id %>" data-panel="edit" data-panel-group="tickets">
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Ticket-Typ</h3>
          <div class="admin-grid">
            <div class="admin-field <%= fieldHasError('ticket_type') ? 'admin-field--error' : '' %>">
              <label>Ticket Typ:</label>
              <select name="ticket_type" required>
                <option value="">Bitte auswählen</option>
                <option value="online" <%= isSelected(primaryTicket.ticket_type, 'online') %>>Onlineticket erstellen</option>
                <option value="kino" <%= isSelected(primaryTicket.ticket_type, 'kino') %>>Kinoticket erstellen</option>
                <option value="combo" <%= isSelected(primaryTicket.ticket_type, 'combo') %>>Kombiticket erstellen</option>
              </select>
            </div>
          </div>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Preis &amp; Rabatte</h3>
          <div class="admin-grid">
            <div class="admin-field <%= fieldHasError('ticket_event_price') ? 'admin-field--error' : '' %>">
              <label>Regulärer Preis (€):</label>
              <input type="text" name="ticket_event_price" value="<%= safeValue(baseEventPrice) %>" required>
            </div>
            <div class="admin-field <%= fieldHasError('ticket_preorder_percent') ? 'admin-field--error' : '' %>">
              <label>Pre-Order Rabatt (%):</label>
              <input type="number" name="ticket_preorder_percent" min="0" max="100" value="<%= safeValue(calculateDiscountPercent(ticketPhaseMap.preorder)) %>" required>
            </div>
            <div class="admin-field <%= fieldHasError('ticket_preorder_end') ? 'admin-field--error' : '' %>">
              <label>Pre-Order gültig bis:</label>
              <input type="date" name="ticket_preorder_end" value="<%= safeValue(formatDateValue(ticketPhaseMap.preorder?.end_at)) %>" required>
            </div>
          </div>
          <div class="admin-grid">
            <div class="admin-field <%= fieldHasError('ticket_early_percent') ? 'admin-field--error' : '' %>">
              <label>Frühbucher Rabatt (%):</label>
              <input type="number" name="ticket_early_percent" min="0" max="100" value="<%= safeValue(calculateDiscountPercent(ticketPhaseMap.early)) %>">
            </div>
            <div class="admin-field <%= fieldHasError('ticket_early_end') ? 'admin-field--error' : '' %>">
              <label>Frühbucher gültig bis:</label>
              <input type="date" name="ticket_early_end" value="<%= safeValue(formatDateValue(ticketPhaseMap.early?.end_at)) %>">
            </div>
          </div>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Ticket Inhalte (alle Sprachen)</h3>
          <% langs.forEach((lang) => { %>
          <div class="admin-panel__section">
            <h4><%= lang.label %></h4>
            <div class="admin-grid">
              <div class="admin-field <%= fieldHasError(`ticket_${lang.key}_title`) ? 'admin-field--error' : '' %>">
                <label>Titel:</label>
                <input type="text" name="ticket_<%= lang.key %>_title" value="<%= safeValue(ticketValue(lang.key, 'title')) %>">
              </div>
              <div class="admin-field <%= fieldHasError(`ticket_${lang.key}_text`) ? 'admin-field--error' : '' %>">
                <label>Beschreibung:</label>
                <input type="text" name="ticket_<%= lang.key %>_text" value="<%= safeValue(ticketValue(lang.key, 'ticket_text')) %>">
              </div>
            </div>
            <div class="admin-grid">
              <div class="admin-field <%= fieldHasError(`ticket_${lang.key}_badge_text`) ? 'admin-field--error' : '' %>">
                <label>Badge Text:</label>
                <input type="text" name="ticket_<%= lang.key %>_badge_text" value="<%= safeValue(ticketValue(lang.key, 'badge_text')) %>">
              </div>
              <div class="admin-field <%= fieldHasError(`ticket_${lang.key}_badge_bg_color`) ? 'admin-field--error' : '' %>">
                <label>Badge Hintergrundfarbe auswählen:</label>
                <div class="admin-badge-picker" role="radiogroup" aria-label="Badge Hintergrundfarbe">
                  <% badgeColors.forEach((color, index) => { %>
                  <label class="admin-badge-option">
                    <input type="radio" name="ticket_<%= lang.key %>_badge_bg_color" value="<%= color.value %>" data-badge-color-input <%= isSelected(color.value, ticketValue(lang.key, 'badge_bg_color')) %>>
                    <span class="admin-badge-option__preview" style="--badge-color: <%= color.value %>;">
                      <span class="admin-badge-option__letter">A</span>
                    </span>
                    <span class="admin-badge-option__label"><%= color.label %></span>
                  </label>
                  <% }) %>
                </div>
                <input type="hidden" name="ticket_<%= lang.key %>_badge_text_color" data-badge-text-color value="<%= safeValue(ticketValue(lang.key, 'badge_text_color')) %>">
              </div>
            </div>
            <div class="admin-grid">
              <div class="admin-field <%= fieldHasError(`ticket_${lang.key}_hint_text`) ? 'admin-field--error' : '' %>">
                <label>Hinweistext:</label>
                <input type="text" name="ticket_<%= lang.key %>_hint_text" value="<%= safeValue(ticketValue(lang.key, 'hint_text')) %>">
              </div>
              <div class="admin-field <%= fieldHasError(`ticket_${lang.key}_button_label`) ? 'admin-field--error' : '' %>">
                <label>Button Text:</label>
                <input type="text" name="ticket_<%= lang.key %>_button_label" value="<%= safeValue(ticketValue(lang.key, 'button_label')) %>">
              </div>
              <div class="admin-field <%= fieldHasError(`ticket_${lang.key}_button_url`) ? 'admin-field--error' : '' %>">
                <label>Button Link:</label>
                <input type="text" name="ticket_<%= lang.key %>_button_url" value="<%= safeValue(ticketValue(lang.key, 'button_url')) %>">
              </div>
            </div>
            <div class="admin-grid">
              <% for (let index = 1; index <= 5; index += 1) { %>
              <div class="admin-field">
                <label>Feature <%= index %>:</label>
                <input type="text" name="ticket_<%= lang.key %>_feature_<%= index %>" value="<%= safeValue(ticketFeatures(lang.key)[index - 1]?.feature_text) %>">
              </div>
              <% } %>
            </div>
          </div>
          <% }) %>
        </div>

        <div class="admin-panel__actions">
          <button type="submit" class="admin-button">Speichern ✓</button>
        </div>
      </form>
      <% } else if (ticketsTab === 'edit') { %>
      <div class="admin-panel" data-panel="edit" data-panel-group="tickets">
        <div class="admin-panel__section">
          <p>Bitte wähle ein Ticket aus, um die Inhalte zu bearbeiten.</p>
        </div>
      </div>
      <% } %>

      <% if (adminError === 'ticket-action' && ticketsTab === 'delete') { %>
      <div class="admin-panel__alert admin-panel__alert--error">
        Bitte wähle mindestens ein Ticket für die Aktion aus.
      </div>
      <% } else if (adminSaved && adminQuery.nav === 'tickets' && ticketsTab === 'delete') { %>
      <div class="admin-panel__alert admin-panel__alert--success">
        Aktion erfolgreich ausgeführt.
      </div>
      <% } %>

      <% if (adminError === 'online-access' && ticketsTab === 'onlineaccess') { %>
      <div class="admin-panel__alert admin-panel__alert--error">
        <% if (adminMissing === 'email') { %>
        Bitte gib eine E-Mail-Adresse an.
        <% } else if (adminMissing === 'order_id') { %>
        Die Bestell-ID ist ungültig.
        <% } else if (adminMissing === 'code') { %>
        Der Code konnte nicht gelöscht werden.
        <% } else { %>
        Es gab ein Problem mit dem Onlinezugang.
        <% } %>
      </div>
      <% } else if (adminSaved && adminQuery.nav === 'tickets' && ticketsTab === 'onlineaccess') { %>
      <div class="admin-panel__alert admin-panel__alert--success">
        Onlinezugang aktualisiert.
      </div>
      <% } %>

      <div class="admin-panel <%= ticketsTab === 'delete' ? '' : 'is-hidden' %>" data-panel="delete" data-panel-group="tickets">
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Tickets ein-/ausblenden</h3>
          <p>Wähle die Tickets aus, die angezeigt, ausgeblendet oder gelöscht werden sollen.</p>
        </div>
        <div class="admin-ticket-grid">
          <% ticketGroups.forEach((group) => { %>
          <% const displayTicket = group.tickets?.de || group.tickets?.en || group.tickets?.ku; %>
          <% if (!displayTicket) return; %>
          <div class="admin-ticket-card" data-ticket-card data-ticket-group-id="<%= group.id %>" data-ticket-languages="<%= Object.keys(group.tickets || {}).join(',') %>" data-ticket-type="<%= displayTicket.ticket_type %>">
            <div class="admin-ticket-card__actions">
              <label class="admin-ticket-card__toggle">
                <input type="checkbox" <%= displayTicket.active ? 'checked' : '' %> data-ticket-action="visibility" data-ticket-group-id="<%= group.id %>" data-ticket-languages="<%= Object.keys(group.tickets || {}).join(',') %>">
                <span>Anzeigen</span>
              </label>
              <button type="button" class="admin-ticket-card__delete" data-ticket-action="delete" data-ticket-group-id="<%= group.id %>" data-ticket-languages="<%= Object.keys(group.tickets || {}).join(',') %>">×</button>
            </div>
            <div class="admin-ticket-card__body">
              <div class="admin-ticket-card__title"><%= displayTicket.title %></div>
              <div class="admin-ticket-card__meta"><%= displayTicket.ticket_type %></div>
              <div class="admin-ticket-card__description"><%= displayTicket.ticket_text || '' %></div>
              <div class="admin-ticket-card__price"><%= displayTicket.event_price ? `${displayTicket.event_price} €` : '' %></div>
            </div>
          </div>
          <% }) %>
        </div>
      </div>

      <div class="admin-panel <%= ticketsTab === 'onlineaccess' ? '' : 'is-hidden' %>" data-panel="onlineaccess" data-panel-group="tickets">
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Neuen Onlinezugang erstellen</h3>
          <form class="admin-grid" method="post" action="/adminbackend/online-access">
            <div class="admin-field">
              <label>E-Mail-Adresse:</label>
              <input type="email" name="email" placeholder="name@example.com" required>
            </div>
            <div class="admin-field">
              <label>Bestell-ID (optional):</label>
              <input type="text" name="order_id" placeholder="z.B. 123">
            </div>
            <div class="admin-panel__actions admin-panel__actions--inline">
              <button type="submit" class="admin-button">Code generieren ✓</button>
            </div>
          </form>
        </div>

        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Alle Onlinezugänge</h3>
          <% if (!onlineAccessList.length) { %>
          <p>Es wurden noch keine Onlinezugänge erstellt.</p>
          <% } else { %>
          <div class="admin-table admin-table--tickets">
            <div class="admin-table__row admin-table__row--header">
              <div>Code</div>
              <div>E-Mail</div>
              <div>Bestell-ID</div>
              <div>Mit Account verbunden</div>
              <div>Eingelöst von</div>
              <div>Erstellt</div>
              <div>Aktion</div>
            </div>
            <% onlineAccessList.forEach((entry) => { %>
            <div class="admin-table__row">
              <div><strong><%= entry.code %></strong></div>
              <div><%= entry.email %></div>
              <div><%= entry.order_id || '—' %></div>
              <div><%= entry.redeemed_by_user_id ? 'ja' : 'nein' %></div>
              <div>
                <% if (entry.redeemed_by_user_id) { %>
                <%= [entry.redeemed_by_first_name, entry.redeemed_by_last_name].filter(Boolean).join(' ') || entry.redeemed_by_email || 'Nutzer' %>
                <% if (entry.redeemed_by_email) { %>
                <small>(<%= entry.redeemed_by_email %>)</small>
                <% } %>
                <% } else { %>
                —
                <% } %>
              </div>
              <div><%= formatDateTime(entry.created_at) %></div>
              <div>
                <form method="post" action="/adminbackend/online-access/<%= entry.id %>/delete">
                  <button type="submit" class="admin-button admin-button--danger">Löschen</button>
                </form>
              </div>
            </div>
            <% }) %>
          </div>
          <% } %>
        </div>
      </div>

      <div class="admin-panel <%= ticketsTab === 'orders' ? '' : 'is-hidden' %>" data-panel="orders" data-panel-group="tickets">
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Ticketkäufe Übersicht</h3>
          <p>Alle Ticketbestellungen inklusive Kinonamen und Onlinezugang.</p>
          <div class="admin-ticket-filters" data-ticket-order-filters>
            <button type="button" class="admin-ticket-filter is-active" data-ticket-order-filter="all">Alle</button>
            <button type="button" class="admin-ticket-filter" data-ticket-order-filter="kino">Kinotickets</button>
            <button type="button" class="admin-ticket-filter" data-ticket-order-filter="online">Onlinetickets</button>
            <button type="button" class="admin-ticket-filter" data-ticket-order-filter="combo">Kombi</button>
          </div>
        </div>
        <div class="admin-panel__section">
          <% if (!ticketOrders.length) { %>
          <p>Es liegen noch keine Ticketkäufe vor.</p>
          <% } else { %>
          <div class="admin-table admin-table--ticket-orders">
            <div class="admin-table__row admin-table__row--header">
              <div>Tickettyp</div>
              <div>Käufer</div>
              <div>E-Mail</div>
              <div>Kinotickets</div>
              <div>Kinonamen</div>
              <div>Online-Code</div>
              <div>Code eingelöst</div>
              <div>Bestellt</div>
            </div>
            <% ticketOrders.forEach((order) => { %>
            <div class="admin-table__row" data-ticket-order-row data-ticket-order-type="<%= order.ticket_type %>" data-ticket-order-kino-quantity="<%= order.kino_quantity || 0 %>">
              <div><strong><%= order.ticket_type %></strong></div>
              <div><%= order.customer_name %></div>
              <div><%= order.customer_email %></div>
              <div><%= order.kino_quantity || 0 %></div>
              <div>
                <% if (order.attendees.length) { %>
                <% order.attendees.forEach((attendee) => { %>
                <div><%= [attendee.first_name, attendee.last_name].filter(Boolean).join(' ') %></div>
                <% }) %>
                <% } else { %>
                —
                <% } %>
              </div>
              <div>
                <% if (order.accessCodes.length) { %>
                <% order.accessCodes.forEach((code) => { %>
                <div><strong><%= code.code %></strong></div>
                <% }) %>
                <% } else { %>
                —
                <% } %>
              </div>
              <div>
                <% if (order.accessCodes.length) { %>
                <% order.accessCodes.forEach((code) => { %>
                <div><%= code.redeemed_at ? 'eingelöst' : 'offen' %></div>
                <% }) %>
                <% } else { %>
                —
                <% } %>
              </div>
              <div><%= formatDateTime(order.created_at) %></div>
            </div>
            <% }) %>
          </div>
          <% } %>
        </div>
      </div>

      <div class="admin-panel <%= ticketsTab === 'donations' ? '' : 'is-hidden' %>" data-panel="donations" data-panel-group="tickets">
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Spenden Übersicht</h3>
          <p>Alle Spenden inklusive Kontaktinformationen und Spendenquittung.</p>
        </div>
        <div class="admin-panel__section">
          <% if (!donations.length) { %>
          <p>Es liegen noch keine Spenden vor.</p>
          <% } else { %>
          <div class="admin-table admin-table--donations">
            <div class="admin-table__row admin-table__row--header">
              <div>Status</div>
              <div>Betrag</div>
              <div>Spender</div>
              <div>E-Mail</div>
              <div>Adresse</div>
              <div>Sprache</div>
              <div>Datum</div>
              <div>Aktion</div>
            </div>
            <% donations.forEach((donation) => { %>
            <div class="admin-table__row">
              <div><strong><%= donation.status %></strong></div>
              <div><%= donation.amount_total ? `${Number(donation.amount_total).toFixed(2)} €` : '—' %></div>
              <div><%= [donation.first_name, donation.last_name].filter(Boolean).join(' ') %></div>
              <div><%= donation.email %></div>
              <div>
                <div><%= donation.address_line1 %></div>
                <% if (donation.address_line2) { %>
                <div><%= donation.address_line2 %></div>
                <% } %>
                <div><%= `${donation.postal_code} ${donation.city}` %></div>
                <div><%= donation.country %></div>
              </div>
              <div><%= donation.locale || 'de' %></div>
              <div><%= formatDateTime(donation.created_at) %></div>
              <div>
                <a class="admin-button" href="/adminbackend/donations/<%= donation.id %>/receipt" target="_blank" rel="noopener noreferrer" style="font-size: 10px;">Spendenquittung anzeigen</a>
              </div>
            </div>
            <% }) %>
          </div>
          <% } %>
        </div>
      </div>

      <div class="admin-ticket-modal is-hidden" data-ticket-modal>
        <div class="admin-ticket-modal__backdrop" data-ticket-modal-close></div>
        <div class="admin-ticket-modal__dialog">
          <header class="admin-ticket-modal__header">
            <h3 data-ticket-modal-title>Aktion bestätigen</h3>
            <button type="button" class="admin-ticket-modal__close" data-ticket-modal-close>×</button>
          </header>
          <p data-ticket-modal-text>Bitte wähle die gewünschten Tickets aus.</p>
          <form class="admin-ticket-modal__form" method="post" action="/adminbackend/media-tickets/actions" data-ticket-modal-form>
            <input type="hidden" name="ticket_group_id" value="" data-ticket-modal-group>
            <input type="hidden" name="action" value="" data-ticket-modal-action>
            <input type="hidden" name="visibility" value="" data-ticket-modal-visibility>
            <label class="admin-field admin-field--checkbox">
              <input type="checkbox" data-ticket-modal-all>
              <span data-ticket-modal-all-label>Alle Tickets</span>
            </label>
            <div class="admin-ticket-modal__options">
              <label class="admin-field admin-field--checkbox">
                <input type="checkbox" name="languages" value="de" data-ticket-modal-lang="de">
                <span>Deutsches Ticket</span>
              </label>
              <label class="admin-field admin-field--checkbox">
                <input type="checkbox" name="languages" value="en" data-ticket-modal-lang="en">
                <span>Englisches Ticket</span>
              </label>
              <label class="admin-field admin-field--checkbox">
                <input type="checkbox" name="languages" value="ku" data-ticket-modal-lang="ku">
                <span>Kurdisches Ticket</span>
              </label>
            </div>
            <div class="admin-panel__actions admin-panel__actions--inline">
              <button type="button" class="admin-button admin-button--secondary" data-ticket-modal-close>Abbrechen</button>
              <button type="submit" class="admin-button">Bestätigen ✓</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <div class="admin-content__section is-hidden" data-nav-content="gallery">
      <header class="admin-content__header">
        <h2>Admin Gallery</h2>
        <p>Hier kannst du Bilder und Videos für die Admin Gallery verwalten</p>
      </header>
      <% if (adminError === 'gallery-duplicate-image') { %>
      <div class="admin-panel__alert admin-panel__alert--error">Das Bild existiert bereits in der Gallery und wurde nicht erneut hochgeladen.</div>
      <% } else if (adminError === 'gallery-duplicate-video') { %>
      <div class="admin-panel__alert admin-panel__alert--error">Das Video existiert bereits in der Gallery und wurde nicht erneut hochgeladen.</div>
      <% } %>
      <div class="admin-tabs admin-tabs--sub" data-gallery-tabs>
        <button class="admin-tab is-active" type="button" data-gallery-tab="images">Bilder</button>
        <button class="admin-tab" type="button" data-gallery-tab="videos">Videos</button>
      </div>
      <section class="admin-panel" data-panel="gallery" data-panel-group="gallery">
        <div class="admin-panel__section">
          <form class="admin-panel__actions admin-panel__actions--inline" id="admin-gallery-visibility-form" method="post" action="/adminbackend/gallery/visibility">
            <button type="submit" class="admin-button">Änderungen speichern</button>
          </form>
        </div>

        <div class="admin-gallery-panel" data-gallery-panel="images">
          <div class="admin-panel__section">
            <h3 class="admin-panel__title">Neues Bild hochladen</h3>
            <form class="admin-gallery-form" method="post" action="/adminbackend/gallery/images" enctype="multipart/form-data">
              <div class="admin-grid">
                <div class="admin-field">
                  <label>Bilddatei:</label>
                  <input type="file" name="gallery_image_file" accept="image/*" required>
                </div>
                <div class="admin-field">
                  <label>Alt-Text Deutsch:</label>
                  <input type="text" name="gallery_image_alt_de" placeholder="Alt-Text Deutsch" required>
                </div>
                <div class="admin-field">
                  <label>Alt-Text Englisch:</label>
                  <input type="text" name="gallery_image_alt_en" placeholder="Alt-Text Englisch" required>
                </div>
              </div>
              <div class="admin-grid">
                <div class="admin-field">
                  <label>Alt-Text Kurdisch:</label>
                  <input type="text" name="gallery_image_alt_ku" placeholder="Alt-Text Kurdisch" required>
                </div>
              </div>
              <div class="admin-panel__actions">
                <button type="submit" class="admin-button">Bild hochladen ✓</button>
              </div>
            </form>
          </div>

          <div class="admin-panel__section">
            <h3 class="admin-panel__title">Alle Bilder</h3>
            <form class="admin-panel__actions admin-panel__actions--inline" method="post" action="/adminbackend/gallery/images/sort" data-gallery-sort-form>
              <input type="hidden" name="order" value="[]" data-gallery-sort-input>
              <button type="submit" class="admin-button">Sortierung speichern</button>
            </form>
            <% if (galleryImages?.length) { %>
            <div class="admin-gallery-grid" data-gallery-sortable>
              <% galleryImages.forEach((image) => { %>
              <div class="admin-gallery-card" draggable="true" data-gallery-sort-item data-gallery-id="<%= image.id %>" data-gallery-visible="<%= image.show_in_gallery ? 'true' : 'false' %>">
                <button class="admin-gallery-card__handle" type="button" aria-label="Bild sortieren" data-gallery-drag-handle>↕</button>
                <div class="admin-gallery-visibility">
                  <input type="hidden" name="images[id_<%= image.id %>]" value="0" form="admin-gallery-visibility-form">
                  <label>
                    <input type="checkbox" name="images[id_<%= image.id %>]" value="1" form="admin-gallery-visibility-form" data-gallery-visibility <%= image.show_in_gallery ? 'checked' : '' %>>
                    <span>showInGallery</span>
                  </label>
                </div>
                <% if (image.show_in_gallery) { %>
                <div class="admin-field admin-field-gallery-category">
                  <label for="image-category-<%= image.id %>">Kategorie</label>
                  <select id="image-category-<%= image.id %>" name="image_categories[id_<%= image.id %>]" form="admin-gallery-visibility-form">
                    <% galleryCategoryOptions.forEach((option) => { %>
                    <option value="<%= option.value %>" <%= isSelected(image.gallery_category || 'moments', option.value) %>><%= option.label %></option>
                    <% }) %>
                  </select>
                </div>
                <% } %>
                <form class="admin-gallery-delete" method="post" action="/adminbackend/gallery/images/<%= image.id %>/delete">
                  <button type="submit" aria-label="Bild löschen">×</button>
                </form>
                <img src="<%= image.cloudinary_url || image.local_path %>" alt="<%= image.alt_de || '' %>">
                <div class="admin-gallery-meta">
                  <p><strong>Datei:</strong> <%= image.original_name || image.filename %></p>
                  <p><strong>Maße:</strong> <%= image.width || '-' %> × <%= image.height || '-' %></p>
                  <p><strong>Größe:</strong> <%= image.size_bytes || '-' %> Bytes</p>
                  <p><strong>Alt (DE):</strong> <%= image.alt_de || '-' %></p>
                  <p><strong>Alt (EN):</strong> <%= image.alt_en || '-' %></p>
                  <p><strong>Alt (KU):</strong> <%= image.alt_ku || '-' %></p>
                  <p><strong>Kategorie:</strong> <%= galleryCategoryLabel(image.gallery_category) %></p>
                </div>
              </div>
              <% }) %>
            </div>
            <% } else { %>
            <p class="admin-empty">Keine Bilder vorhanden.</p>
            <% } %>
          </div>
        </div>
        <div class="admin-gallery-panel is-hidden" data-gallery-panel="videos">
          <div class="admin-panel__section">
            <h3 class="admin-panel__title">Neues Video hochladen</h3>
            <form class="admin-gallery-form" method="post" action="/adminbackend/gallery/videos" enctype="multipart/form-data">
              <div class="admin-grid">
                <div class="admin-field">
                  <label>Videodatei:</label>
                  <input type="file" name="gallery_video_file" accept="video/*" required>
                </div>
                <div class="admin-field">
                  <label>Alt-Text Deutsch:</label>
                  <input type="text" name="gallery_video_alt_de" placeholder="Alt-Text Deutsch" required>
                </div>
                <div class="admin-field">
                  <label>Alt-Text Englisch:</label>
                  <input type="text" name="gallery_video_alt_en" placeholder="Alt-Text Englisch" required>
                </div>
              </div>
              <div class="admin-grid">
                <div class="admin-field">
                  <label>Alt-Text Kurdisch:</label>
                  <input type="text" name="gallery_video_alt_ku" placeholder="Alt-Text Kurdisch" required>
                </div>
              </div>
              <div class="admin-panel__actions">
                <button type="submit" class="admin-button">Video hochladen ✓</button>
              </div>
            </form>
          </div>

          <div class="admin-panel__section">
            <h3 class="admin-panel__title">Alle Filme</h3>
            <form class="admin-panel__actions admin-panel__actions--inline" method="post" action="/adminbackend/gallery/videos/sort" data-gallery-sort-form>
              <input type="hidden" name="order" value="[]" data-gallery-sort-input>
              <button type="submit" class="admin-button">Sortierung speichern</button>
            </form>
            <% if (galleryVideos?.length) { %>
            <div class="admin-gallery-grid" data-gallery-sortable>
              <% galleryVideos.forEach((video) => { %>
              <div class="admin-gallery-card" draggable="true" data-gallery-sort-item data-gallery-id="<%= video.id %>" data-gallery-visible="<%= video.show_in_gallery ? 'true' : 'false' %>">
                <button class="admin-gallery-card__handle" type="button" aria-label="Video sortieren" data-gallery-drag-handle>↕</button>
                <div class="admin-gallery-visibility">
                  <input type="hidden" name="videos[id_<%= video.id %>]" value="0" form="admin-gallery-visibility-form">
                  <label>
                    <input type="checkbox" name="videos[id_<%= video.id %>]" value="1" form="admin-gallery-visibility-form" data-gallery-visibility <%= video.show_in_gallery ? 'checked' : '' %>>
                    <span>showInGallery</span>
                  </label>
                </div>
                <% if (video.show_in_gallery) { %>
                <div class="admin-field admin-field-gallery-category">
                  <label for="video-category-<%= video.id %>">Kategorie</label>
                  <select id="video-category-<%= video.id %>" name="video_categories[id_<%= video.id %>]" form="admin-gallery-visibility-form">
                    <% galleryCategoryOptions.forEach((option) => { %>
                    <option value="<%= option.value %>" <%= isSelected(video.gallery_category || 'moments', option.value) %>><%= option.label %></option>
                    <% }) %>
                  </select>
                </div>
                <% } %>
                <form class="admin-gallery-delete" method="post" action="/adminbackend/gallery/videos/<%= video.id %>/delete">
                  <button type="submit" aria-label="Video löschen">×</button>
                </form>
                <video controls preload="metadata">
                  <source src="<%= video.cloudinary_url || video.local_path %>">
                </video>
                <div class="admin-gallery-meta">
                  <p><strong>Datei:</strong> <%= video.original_name || video.filename %></p>
                  <p><strong>Maße:</strong> <%= video.width || '-' %> × <%= video.height || '-' %></p>
                  <p><strong>Größe:</strong> <%= video.size_bytes || '-' %> Bytes</p>
                  <p><strong>Alt (DE):</strong> <%= video.alt_de || '-' %></p>
                  <p><strong>Alt (EN):</strong> <%= video.alt_en || '-' %></p>
                  <p><strong>Alt (KU):</strong> <%= video.alt_ku || '-' %></p>
                  <p><strong>Kategorie:</strong> <%= galleryCategoryLabel(video.gallery_category) %></p>
                </div>
              </div>
              <% }) %>
            </div>
            <% } else { %>
            <p class="admin-empty">Keine Videos vorhanden.</p>
            <% } %>
          </div>
        </div>
      </section>
    </div>

    <div class="admin-content__section is-hidden" data-nav-content="sponsors">
      <header class="admin-content__header">
        <h2>Sponsoren verwalten</h2>
        <p>Füge Sponsoren hinzu, bearbeite bestehende Einträge oder lösche sie.</p>
        <div class="admin-tabs" data-admin-tabs="sponsors">
          <button class="admin-tab <%= sponsorsTab === 'create' ? 'is-active' : '' %>" type="button" data-tab="create">Sponsor hinzufügen</button>
          <button class="admin-tab <%= sponsorsTab === 'manage' ? 'is-active' : '' %>" type="button" data-tab="manage">Sponsoren verwalten</button>
        </div>
      </header>

      <form class="admin-panel <%= sponsorsTab === 'create' ? '' : 'is-hidden' %>" method="post" action="/adminbackend/sponsors" enctype="multipart/form-data" data-panel="create" data-panel-group="sponsors">
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Neuen Sponsor anlegen</h3>
          <div class="admin-grid">
            <div class="admin-field">
              <label>Name des Sponsors:</label>
              <input type="text" name="sponsor_name" placeholder="Name eingeben..." required>
            </div>
          </div>
          <div class="admin-grid">
            <div class="admin-field">
              <label>Beschreibung (DE):</label>
              <textarea name="sponsor_description_de" placeholder="Beschreibung auf Deutsch eingeben..."></textarea>
            </div>
            <div class="admin-field">
              <label>Description (EN):</label>
              <textarea name="sponsor_description_en" placeholder="Description in English..."></textarea>
            </div>
            <div class="admin-field">
              <label>Navê sponsor (KU):</label>
              <textarea name="sponsor_description_ku" placeholder="Danasîna bi kurdî..."></textarea>
            </div>
          </div>
          <div class="admin-grid">
            <div class="admin-field">
              <label>Link (optional):</label>
              <input type="url" name="sponsor_link" placeholder="https://...">
            </div>
          </div>
          <div class="admin-grid">
            <div class="admin-field">
              <label>Bild:</label>
              <div class="admin-media-picker" data-gallery-picker data-gallery-allow="image">
                <div class="admin-media-picker__controls">
                  <button class="admin-button admin-button--secondary" type="button" data-gallery-open>Datei auswählen</button>
                  <button class="admin-button admin-button--secondary" type="button" data-upload-trigger>Datei hochladen</button>
                  <input type="file" name="sponsor_image" accept="image/*" data-upload-input hidden>
                </div>
                <input type="hidden" name="sponsor_gallery_image_id" data-gallery-input="image">
                <small data-gallery-preview>Keine Datei ausgewählt.</small>
              </div>
            </div>
          </div>
        </div>

        <div class="admin-panel__actions">
          <button type="submit" class="admin-button">Sponsor speichern ✓</button>
        </div>
      </form>

      <section class="admin-panel <%= sponsorsTab === 'manage' ? '' : 'is-hidden' %>" data-panel="manage" data-panel-group="sponsors">
        <div class="admin-panel__section">
          <h3 class="admin-panel__title">Sponsorenliste</h3>
          <div class="admin-team-list">
            <% (sponsors || []).forEach((sponsor) => { %>
            <div class="admin-team-card">
              <div class="admin-team-card__info">
                <% if (sponsor.image_url) { %>
                <img src="<%= sponsor.image_url %>" alt="<%= sponsor.name %>">
                <% } %>
                <div>
                  <strong><%= sponsor.name %></strong>
                  <% if (sponsor.link_url) { %>
                  <div>
                    <a href="<%= sponsor.link_url %>" target="_blank" rel="noopener noreferrer"><%= sponsor.link_url %></a>
                  </div>
                  <% } %>
                </div>
              </div>
              <div class="admin-team-card__actions">
                <form method="post" action="/adminbackend/sponsors/<%= sponsor.id %>/delete">
                  <button type="submit" class="admin-button admin-button--danger">Löschen</button>
                </form>
              </div>
              <details class="admin-team-card__edit">
                <summary class="admin-button admin-button--secondary">Bearbeiten</summary>
                <form method="post" action="/adminbackend/sponsors/<%= sponsor.id %>/update" enctype="multipart/form-data">
                  <div class="admin-grid">
                    <div class="admin-field">
                      <label>Name des Sponsors:</label>
                      <input type="text" name="sponsor_name" value="<%= safeValue(sponsor.name) %>" required>
                    </div>
                  </div>
                  <div class="admin-grid">
                    <div class="admin-field">
                      <label>Beschreibung (DE):</label>
                      <textarea name="sponsor_description_de" placeholder="Beschreibung auf Deutsch eingeben..."><%= safeValue(sponsor.description_de) %></textarea>
                    </div>
                    <div class="admin-field">
                      <label>Description (EN):</label>
                      <textarea name="sponsor_description_en" placeholder="Description in English..."><%= safeValue(sponsor.description_en) %></textarea>
                    </div>
                    <div class="admin-field">
                      <label>Navê sponsor (KU):</label>
                      <textarea name="sponsor_description_ku" placeholder="Danasîna bi kurdî..."><%= safeValue(sponsor.description_ku) %></textarea>
                    </div>
                  </div>
                  <div class="admin-grid">
                    <div class="admin-field">
                      <label>Link (optional):</label>
                      <input type="url" name="sponsor_link" value="<%= safeValue(sponsor.link_url) %>" placeholder="https://...">
                    </div>
                  </div>
                  <div class="admin-grid">
                    <div class="admin-field">
                      <label>Bild:</label>
                      <div class="admin-media-picker" data-gallery-picker data-gallery-allow="image">
                        <div class="admin-media-picker__controls">
                          <button class="admin-button admin-button--secondary" type="button" data-gallery-open>Datei auswählen</button>
                          <button class="admin-button admin-button--secondary" type="button" data-upload-trigger>Datei hochladen</button>
                          <input type="file" name="sponsor_image" accept="image/*" data-upload-input hidden>
                        </div>
                        <input type="hidden" name="sponsor_gallery_image_id" data-gallery-input="image">
                        <input type="hidden" name="sponsor_existing_image" value="<%= safeValue(sponsor.image_url) %>">
                        <small data-gallery-preview><%= sponsor.image_url ? 'Bild vorhanden.' : 'Keine Datei ausgewählt.' %></small>
                      </div>
                    </div>
                  </div>
                  <div class="admin-panel__actions">
                    <button type="submit" class="admin-button">Änderungen speichern ✓</button>
                  </div>
                </form>
              </details>
            </div>
            <% }) %>
            <% if (!sponsors || !sponsors.length) { %>
            <p class="admin-empty">Keine Sponsoren vorhanden.</p>
            <% } %>
          </div>
        </div>
      </section>
    </div>

    <div class="admin-gallery-selector is-hidden" data-gallery-selector>
      <div class="admin-gallery-selector__backdrop" data-gallery-close></div>
      <div class="admin-gallery-selector__modal" role="dialog" aria-modal="true">
        <div class="admin-gallery-selector__header">
          <h3>Datei auswählen</h3>
          <button class="admin-gallery-selector__close" type="button" data-gallery-close aria-label="Schließen">×</button>
        </div>
        <div class="admin-gallery-selector__tabs" data-gallery-selector-tabs>
          <button class="admin-tab is-active" type="button" data-gallery-selector-tab="images">Bilder</button>
          <button class="admin-tab" type="button" data-gallery-selector-tab="videos">Videos</button>
        </div>
        <div class="admin-gallery-selector__panel" data-gallery-selector-panel="images">
          <% if (galleryImages?.length) { %>
          <div class="admin-gallery-selector__grid">
            <% galleryImages.forEach((image) => { %>
            <button class="admin-gallery-selector__item" type="button" data-gallery-item data-gallery-item-type="image" data-gallery-item-id="<%= image.id %>" data-gallery-item-label="<%= image.original_name || image.filename %>" data-gallery-item-url="<%= image.cloudinary_url || image.local_path %>" data-gallery-item-alt-de="<%= image.alt_de || '' %>" data-gallery-item-alt-en="<%= image.alt_en || '' %>" data-gallery-item-alt-ku="<%= image.alt_ku || '' %>">
              <img src="<%= image.cloudinary_url || image.local_path %>" alt="<%= image.alt_de || '' %>">
              <span><%= image.original_name || image.filename %></span>
            </button>
            <% }) %>
          </div>
          <% } else { %>
          <p class="admin-empty">Keine Bilder vorhanden.</p>
          <% } %>
        </div>
        <div class="admin-gallery-selector__panel is-hidden" data-gallery-selector-panel="videos">
          <% if (galleryVideos?.length) { %>
          <div class="admin-gallery-selector__grid">
            <% galleryVideos.forEach((video) => { %>
            <button class="admin-gallery-selector__item" type="button" data-gallery-item data-gallery-item-type="video" data-gallery-item-id="<%= video.id %>" data-gallery-item-label="<%= video.original_name || video.filename %>" data-gallery-item-url="<%= video.cloudinary_url || video.local_path %>" data-gallery-item-alt-de="<%= video.alt_de || '' %>" data-gallery-item-alt-en="<%= video.alt_en || '' %>" data-gallery-item-alt-ku="<%= video.alt_ku || '' %>">
              <video preload="metadata">
                <source src="<%= video.cloudinary_url || video.local_path %>">
              </video>
              <span><%= video.original_name || video.filename %></span>
            </button>
            <% }) %>
          </div>
          <% } else { %>
          <p class="admin-empty">Keine Videos vorhanden.</p>
          <% } %>
        </div>
      </div>
    </div>
  </section>
</section>