<%
  const heroHeadline = block?.headline || 'Ihre Gebäudereinigung in Berlin';
  const heroSubline = block?.subline || 'zuverlässig, schnell und günstig Gebäude in Berlin reinigen lassen';
  const heroCtaLabel = block?.cta?.label || block?.ctaLabel || 'Beratungstermin buchen';
  const heroCtaHref = block?.cta?.href || block?.ctaHref || '#kontakt';
  const heroImage = block?.image || '/images/team.webp';
  const isLeistungenPage =
      page?.canonical_path?.startsWith('/leistungen')
    || ['leistungen', 'leistungen-de', 'leistungen-en'].includes(page?.slug);
  const isLeistungenSubpage =
      page?.canonical_path?.startsWith('/leistungen/')
    && page?.canonical_path !== '/leistungen';
  const breadcrumbCurrentLabel = (page?.title || heroHeadline || '').replace(/<[^>]*>/g, ' ').replace(/\s+/g, ' ').trim();
  const heroLayout = block?.layout || (isLeistungenSubpage ? 'leistungen-detail' : (isLeistungenPage ? 'leistungen' : 'default'));
  const isLeistungenHero = heroLayout === 'leistungen' || heroLayout === 'leistungen-detail';
  const galleryDefaults = ['80%', '100%', '80%'];
  const galleryItems = Array.isArray(block?.gallery) && block.gallery.length
    ? block.gallery
    : [
        { src: heroImage, alt: heroHeadline, width: galleryDefaults[0] },
        { src: heroImage, alt: heroHeadline, width: galleryDefaults[1] },
        { src: heroImage, alt: heroHeadline, width: galleryDefaults[2] }
      ];
%>
<section class="sauber-hero <%= isLeistungenHero ? 'sauber-hero--leistungen' : '' %> <%= heroLayout === 'leistungen-detail' ? 'sauber-hero--leistungen-detail' : '' %>" aria-labelledby="sauber-hero-title">
  <% if (isLeistungenHero) { %>
  <div class="section__inner sauber-hero__inner animate-on-scroll">
    <% if (heroLayout === 'leistungen') { %>
    <header class="sauber-hero__header">
      <nav class="sauber-hero__breadcrumb" aria-label="Breadcrumb">
        <a href="/">Startseite</a>
        <span class="sauber-hero__breadcrumb-separator" aria-hidden="true">›</span>
        <span aria-current="page">Leistungen</span>
      </nav>
    </header>
    <h1 class="sauber-hero__title" id="sauber-hero-title"><%- renderTextWithLinks(heroHeadline) %></h1>
    <% } %>
    <div class="sauber-hero__body">
      <div class="sauber-hero__text">
        <% if (heroLayout === 'leistungen-detail') { %>
        <div class="breadcrumb-hero__container">
          <header class="sauber-hero__header">
            <nav class="sauber-hero__breadcrumb" aria-label="Breadcrumb">
              <a href="/">Startseite</a>
              <span class="sauber-hero__breadcrumb-separator" aria-hidden="true">›</span>
              <a href="/leistungen">Leistungen</a>
              <span class="sauber-hero__breadcrumb-separator" aria-hidden="true">›</span>
              <span aria-current="page"><%= breadcrumbCurrentLabel || 'Unterseite' %></span>
            </nav>
          </header>
          <h1 class="sauber-hero__title" id="sauber-hero-title"><%- renderTextWithLinks(heroHeadline) %></h1>
        </div>
        <% } %>
        <p class="sauber-hero__subtitle"><%- renderTextWithLinks(heroSubline) %></p>
        <div class="sauber-hero__actions">
          <a class="sauber-hero__button" href="tel:+491795163864">Jetzt anrufen</a>
          <a class="sauber-hero__button sauber-hero__button--secondary" href="https://wa.me/491795163864" target="_blank" rel="noopener noreferrer">WhatsApp</a>
        </div>
      </div>
      <% if (heroLayout === 'leistungen-detail') { %>
      <div class="sauber-hero__gallery">
        <% galleryItems.forEach((item, index) => { %>
        <div class="sauber-hero__gallery-item" style="--gallery-width: <%= item?.width || galleryDefaults[index] || '432px' %>;">
          <% if (item?.src) { %>
          <img src="<%= item.src %>" alt="<%= item.alt || heroHeadline %>" loading="lazy" />
          <% } %>
        </div>
        <% }) %>
      </div>
      <% } else { %>
      <div class="sauber-hero__visual">
        <img src="<%= heroImage %>" alt="<%= heroHeadline %>" loading="lazy" />
      </div>
      <% } %>
    </div>
  </div>
  <% } else { %>
  <div class="sauber-hero__media" style="--hero-image: url('<%= heroImage %>')"></div>
  <div class="sauber-hero__content animate-on-scroll">
    <div class="sauber-hero__upper">
      <h1 class="sauber-hero__title" id="sauber-hero-title"><%- renderTextWithLinks(heroHeadline) %></h1>
      <p class="sauber-hero__subtitle"><%- renderTextWithLinks(heroSubline) %></p>
    </div>
    <a class="sauber-hero__button" href="<%= heroCtaHref %>"><%= heroCtaLabel %></a>
  </div>
  <% } %>
</section>